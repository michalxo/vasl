package VASL.build.module.fullrules.ObjectClasses;




 /*
        Public Class German338c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class

        Public Class German548c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class German238c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class German237c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then

        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class German247c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class German8_1c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        Else
        UnitTexture = ""
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanConc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        Else
        UnitTexture = "geqmark"
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        ''If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianConc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        Else
        UnitTexture = "ruqmark"
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        ''If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianDummyc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        Else
        UnitTexture = "rucon"
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        ''If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian447c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian458c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian527c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian426c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian628c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian226c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian227c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian237c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use empty variables when know that instance already exist
        Dim NewOBUnit As DataClassLibrary.OrderofBattle
        If PassUnit_ID = 0 Then 'new unit, save to database and create unit ID
        NewOBUnit = Linqdata.CreateNewUnitinDB(PassCharacterStatus, PassCombatStatus, PassCon_ID, PassCX, PassELR, PassFirstSWLink, PassFortitudeStatus,
        PassHexEntSideCrossed, Passhexlocation, PassHexname, PassHexnum, CInt(PassLevelinHex), PassLOBLink,
        PassLOCIndex, PassMovementStatus, PassNationality, PassUnitName, PassOrderStatus, PassPinned, PasshexPosition,
        PassRoleStatus, PassScenario, PassSecondSWlink, PassSW, PassTurnArrives, PassVisibilityStatus)
        myBasePU.SetID(NewOBUnit.OBUnit_ID)
        End If

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian248c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian8_1c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        Else
        UnitTexture = ""
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Then Unittexture &= "wnd"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian138c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        'ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        '    UnitTexture = "Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))"
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = "Herob" 'Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        Else
        UnitTexture = ""
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class Russian149c
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Then  ' Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = "Herob" 'Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = "Hero" 'Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)
        Else
        UnitTexture = ""
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class PrisonerSquadc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class PrisonerHSquadc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class PrisonerSMCc
        Implements PersUniti
        'encapsulation variables
        Private myBasePU As Basepersuniti
        Private myMovingPU As MovingPersuniti
        Private myFiringPU As FiringPersUniti
        Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassHexname As String, ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassELR As Integer, ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassFirstSWLink As Integer, ByVal PassSecondSWlink As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassUnitClass As Integer, ByVal PassCharacterStatus As Integer, ByVal PassUtype As Integer, ByVal PassRoleStatus As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBasePU = New BasePersunitc(PassHexname, PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassELR, PassTurnArrives, PassNationality,
        PassCon_ID, PassUnit_ID, PassTypeType_ID, PassFirstSWLink, PassSecondSWlink, PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassUnitClass, PassCharacterStatus, PassUtype, PassRoleStatus)

        End Sub

        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit
        Get
        Return myBasePU
        End Get
        Set(value As Basepersuniti)

        End Set
        End Property
        'these properties are populated as required by game actions
        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit

        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        Get
        Return myTargetPU
        End Get
        Set(value As TargetPersUniti)
        myTargetPU = value
        End Set
        End Property
        'methods
        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBasePU.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBasePU.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBasePU.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBasePU.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Berserk Then Unittexture &= "bers"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBasePU.CX = True Then Unittexture &= "cx"
        If Me.myBasePU.Pinned Then Unittexture &= "pin"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBasePU.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBasePU.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBasePU.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBasePU.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        'concrete classes that implement MovingPersUniti
        Public Class German838Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBName = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 3
        End Get
        End Property
        End Class
        Public Class German548Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBName = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 2
        End Get
        End Property
        End Class
        Public Class German467Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 1
        End Get
        End Property
        End Class
        Public Class German338Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class German238Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class German237Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class German247Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class German8_1Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 1
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class GermanConMovec
        Implements MovingPersuniti

        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private myIsDummy As Boolean

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        'If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False  'myIsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian628Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian527Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian447Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian426Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 3
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian458Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian226Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 3
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian227Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian237Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian248Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBname As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBname
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian8_1Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 1
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian149Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 1
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class Russian138Movec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 3
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class RussianConMovec
        Implements MovingPersuniti

        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private myIsDummy As Boolean

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        'If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False  'myIsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class RussianDummyMovec
        Implements MovingPersuniti

        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private myIsDummy As Boolean

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        'If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return "?" 'ConcreteUnit.Concounter
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return True
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class PrisonerSquadMovec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class PrisonerHalfSquadMovec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        Public Class PrisonerSMCMovec
        Implements MovingPersuniti
        Private concealedvalue As Boolean
        Private myOBName As String
        Private currhex As Integer
        Private currhexloc As Integer
        Private currhexpos As Integer
        Private OBID As Integer
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private AMvalue As Integer
        Private Dashvalue As Integer
        Private LOCIndexvalue As Integer
        Private HexEntSideCross As Integer
        'Private mysmokee As Integer

        Public Sub New(ByVal PassOBname As String, ByVal Passhexnum As Integer, ByVal Passhexlocation As Integer, ByVal PassPosition As Integer, ByVal PassLocIndex As Integer,
        ByVal PassOBUnitID As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassConID As Integer, ByVal PasshexEnteredSideCrossedLastMove As Integer)

        myOBname = PassOBname
        currhex = Passhexnum
        currhexloc = Passhexlocation
        currhexpos = PassPosition
        LOCIndexvalue = PassLocIndex
        OBID = PassOBUnitID
        If PassVisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed And PassConID > 0 Then concealedvalue = True
        UsingDTvalue = False : UsingRBvalue = False
        HexEntSideCross = PasshexEnteredSideCrossedLastMove
        End Sub
        Public Function CalcMF() As Single Implements MovingPersuniti.CalcMF
        Return 4
        End Function

        Public Property MFAvailable As Single Implements MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements MovingPersuniti.ItemName
        Get
        Return myOBName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements MovingPersuniti.ItemID
        Get
        Return OBID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements MovingPersuniti.IPC
        Get
        Return 0
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements MovingPersuniti.IsConcealed
        Get
        Return concealedvalue
        End Get
        Set(value As Boolean)
        concealedvalue = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements MovingPersuniti.HasLdrBonus
        Get
        Return hasldrbvalue
        End Get
        Set(value As Boolean)
        hasldrbvalue = value
        End Set
        End Property

        Public Property MFUsed As Single Implements MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements MovingPersuniti.AssaultMove
        Get
        Return AMvalue
        End Get
        Set(value As Integer)
        AMvalue = value
        End Set
        End Property
        Public Property Dash As Integer Implements MovingPersuniti.Dash
        Get
        Return Dashvalue
        End Get
        Set(value As Integer)
        Dashvalue = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return HexEntSideCross
        End Get
        Set(value As Integer)
        HexEntSideCross = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return 0
        End Get
        End Property
        End Class
        'concrete classes that implement FiringPersUniti
        Public Class German838Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 2
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 8
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return True
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then
        myCombatFP = myCombatFP + 1
        MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & myCombatFP.ToString)
        End If

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function
        End Class 'German838Firec
        Public Class German548Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 4
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 5
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return True
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then
        myCombatFP = myCombatFP + 1
        MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & myCombatFP.ToString)
        End If

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function
        End Class
        Public Class German467Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti
        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 5
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 6
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function
        End Class
        Public Class German338Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 9
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End if
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function


        End Class
        Public Class German238Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 11
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function


        End Class
        Public Class German247Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 12
        End Get
        End Property
        'Public ReadOnly Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        '    Get
        '        Return myCombatStatus
        '    End Get
        'End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function

        Public Property CombatStatus As Integer Implements FiringPersUniti.CombatStatus
        End Class
        Public Class German237Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 13
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function

        End Class
        Public Class Russian628Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 25
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 6
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return True
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then
        myCombatFP = myCombatFP + 1
        MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & myCombatFP.ToString)
        End If
        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function


        End Class
        Public Class Russian447Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 27
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set

        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If ROFdr > 0 Then  'THIS IS NOT A GOOD WAY TO HANDLE THIS; FIND A BETTER WAY
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function


        End Class
        Public Class Russian527Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 28
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 5
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return True
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then
        myCombatFP = myCombatFP + 1
        MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & myCombatFP.ToString)
        End If
        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function

        End Class
        Public Class Russian458Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 26
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 5
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return True
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function

        End Class
        Public Class Russian426Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Squad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 29
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        ''NEEDS TO ADD ROUNDING UP
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount = 2 Then Return False Else Return True
        'End Function

        End Class
        Public Class Russian248Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 31
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function


        End Class
        Public Class Russian237Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 32
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function

        End Class
        Public Class Russian227Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 33
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function

        End Class
        Public Class Russian226Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.HalfSquad
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 34
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 2
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    If MGCount > 0 Then Return False
        'End Function

        End Class
        Public Class German8_1Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.SMC
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 1004
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return False
        End Get
        Set(value As Boolean)
        myUsingInherentFP = False
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    Return False
        'End Function

        End Class
        Public Class Russian8_1Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double = 0
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.SMC
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 1004
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return 0
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return 0
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return False
        End Get
        Set(value As Boolean)
        myUsingInherentFP = False
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification

        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification

        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification


        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification

        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification

        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification

        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification

        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    Return False
        'End Function

        End Class
        Public Class Russian149Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Hero
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 1102
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 1
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Hero
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return -1
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    Return False
        'End Function

        End Class
        Public Class Russian138Firec
        Implements FiringPersUniti


        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.PersUniti

        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)

        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit
        End Sub 'New
        'properties
        Public ReadOnly Property SolID() As Integer Implements FiringPersUniti.SolID
        Get
        Return mySolID
        End Get
        End Property
        Public ReadOnly Property Type() As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Hero
        End Get
        End Property
        Public ReadOnly Property LOBLink() As Integer Implements FiringPersUniti.LOBLink
        Get
        Return 1101
        End Get
        End Property
        Public Property CombatStatus() As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myCX
        End Get
        End Property
        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myIsEncirc
        End Get
        End Property
        Public ReadOnly Property BaseFP() As Integer Implements FiringPersUniti.BaseFP
        Get
        Return 1
        End Get
        End Property
        Public ReadOnly Property BaseRange() As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 3
        End Get
        End Property
        Public ReadOnly Property AssF() As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property
        Public ReadOnly Property CombatFP() As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property
        Public ReadOnly Property LdrDRM() As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property
        Public Property UseHeroOrLeader() As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.Hero
        End Get
        Set(ByVal Usevalue As Integer)
        ' Sets the property value; no implementation required
        End Set
        End Property
        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myIsPinned
        End Get
        Set(value As Boolean)
        myIsPinned = value
        End Set
        End Property
        Public ReadOnly Property HeroDRM() As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return -1
        End Get
        End Property
        Public ReadOnly Property HasMG() As Boolean Implements FiringPersUniti.HasMG
        'called by EnemyValuesConcreteC.CalcFPandDRM_Thread
        'determines if unit has a MG
        Get
        Return myHasMG
        End Get
        End Property
        Public Property FiringMGs As New List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs
        Public Property UsingInherentFP() As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingfirstMG() As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingsecondMG() As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        'methods
        Public Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub
        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub AdvancingFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If

        End Sub
        Public Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub SprayFireModification(ByVal UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        'If UsingSprayFire = True Then
        '    myCombatFP = myCombatFP / 2
        '    'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        'End If
        End Sub
        Public Sub AssaultFireModification(ByVal Phase As Integer) Implements FiringPersUniti.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))

        End Sub
        Public Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub
        Public Sub MGModification() Implements FiringPersUniti.MGModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for crew/HS firing a MG or squad firing two MG

        'no tests built - do before calling
        myCombatFP = 0
        End Sub
        Public Sub CrestStatusModification(ByVal Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub
        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub
        Public Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        myBaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        If Me.UsingfirstMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        If Me.UsingsecondMG Then
        FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        End If
        Linqdata.QuickUpdate()
        End Sub

        'Public Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean Implements FiringPersUniti.CanStillUseInherentFP
        '    Return False
        'End Function

        End Class
        'concrete classes that implement TargetPersUniti
        Public Class German838Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        'Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        'myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 16
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        'Public Property CharacterStatus As Integer Implements TargetPersUniti.CharacterStatus
        '    Get
        '        Return myCharacterStatus
        '    End Get
        '    Set(value As Integer)
        '        myCharacterStatus = value
        '    End Set
        'End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False 'myIsDummy
        End Get
        Set(value As Boolean)
        'myIsDummy = value
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 9
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 9
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Engineer
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(KNum As Integer, TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get

        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German548Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 13
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        'myIsDummy = value
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 11
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 6
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Elite
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German467Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        'Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        'myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 10
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 3
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False 'myIsDummy
        End Get
        Set(value As Boolean)
        'myIsDummy = value
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 12
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 6
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        Return True
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German338Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 6
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 13
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Engineer
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = False
        End Set
        End Property
        End Class
        Public Class German238Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 5
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 13
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Elite
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC
        Return True
        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German247Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 4
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 6
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 10
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 13
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German237Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 3
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 6
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 12
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 14
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.SecondLine
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects

        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class German8_1Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private CheckState As UtilClassLibrary.ASLXNA.StateChecksc
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        If CheckState.ISUnitWounded(myFortitudeStatus) Then Return 7 Else Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 1006
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        If CheckState.ISUnitWounded(myFortitudeStatus) Then Return 7 Else Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 1003
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 2205
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        'End If
        ElseIf Sniperdr = 2 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        'Else
        'Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        'End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class GermanConTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myConlist As List(Of Integer)
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti, ByVal PassConUnits As List(Of Integer))
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myConlist = PassConUnits
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 1006
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 1003
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 0
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return myConlist
        End Get
        Set(value As List(Of Integer))
        myConlist = value
        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact

        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian628Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 12
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 30
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 28
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Engineer
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian447Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myHOBFlag = False
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 7
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 26
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 32
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 29
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        'Name:       TargetCRMCResult()

        'Identifier UC 102

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when CRMC result is obtained on the IFT
        '2.	Target Reduces to half-squad [UC203-TargetReduces]
        '3.	Target Transfers SW [UC215-TargetTransfersSW]
        '4.	Target Adds CVP/CP to scenario totals [UC210-TargetAddsCVP]
        '5.	Use Case ends when target Takes MoraleCheck [UC103-TargetMCResult]

        'Alternate Course A:
        'Condition:


        'Inheritance: UC 112 - HSTargetCRMC
        'Condition: Target is a half-squad

        'Inheritance: UC 122 - SMCTargetCRMC
        'Condition: Target is a SMC


        'Post conditions (List the state(s) the system can be in when this use case ends)
        '1.

        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA
        'Name:       TargetKIAResult()

        'Identifier UC 101

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when a KIA result is obtained from the IFT
        '2.	The Target drops its support weapons [UC209-TargetDropsSW]
        '3.	The Target adds CVP/CP to scenario totals [UC210-TargetAddsCVP]
        '4.	Use case ends when the Target dies [UC201-TargetDies]

        'Alternate Course A:
        'Condition:

        'Inheritance: UC 111 - SMCTargetKIAResult
        'Condition: Target is an SMC

        '            Post conditions
        '1.


        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        'test code
        ODR = 2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR
        'Name:       TargetNoEResult()

        'Identifier UC 105

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when NoEffect result is obtained on the IFT
        '2.	no effect unless broken then DMs [Alternate Course of Action: UC208-TargetDMs]

        'Alternate Course A: UC208-TargetDMs
        'Condition: Target is broken

        'Inheritance:
        'Condition:

        'Post conditions (List the state(s) the system can be in when this use case ends)
        '1.

        If Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        Return True
        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC
        'UC implemented

        'Name:       TargetPTCResult()

        'Identifier UC 104

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when PTC result is obtained on the IFT
        '2.	Determine ML, ldr drm, other TC drm
        '3:          .Dice Roll & Snipercheck
        '4.	Determine Result ( pass, fail)
        '5.
        '6.	If Passes then no effect
        '	unless broken then DMs [Alternate Course of Action: UC208-TargetDMs]
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '	unless broken then DMs [Alternate Course of Action: UC208-TargetDMs]

        'Alternate Course A: UC208-TargetDMs
        'Condition:  Target is Broken

        'Inheritance:
        'Condition:

        'Post conditions (List the state(s) the system can be in when this use case ends)
        '1.



        If Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        If ODR > (Me.MoraleLevel - TargSTackLdrdrm) Then PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins Else PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        ElseIf Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        Return True
        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break
        'Name:       TargetKIABreak()

        'Identifier UC 107

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when Randon Selection on a #KIA result produces a break result for a unit
        '2.	Breaks and is DMd (UC205-TargetBreaks and UC208-TargetDMs) unless broken then Reduces [Alternate Course of Action: UC203-TargetReduces] or broken and HS/Crew then Dies [Alternate Course of Action: UC201-TargetDies].

        'Alternate Course A: UC203-TargetReduces
        'Condition: Target is broken
        'Alternate Course B: UC201-TargetDies
        'Condition: Target is broken HS or Crew

        'Inheritance:
        'Condition:

        'Post conditions (List the state(s) the system can be in when this use case ends)
        '1.
        If Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        Return True
        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HoBImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian527Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 7
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 25
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 33
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 29
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian458Targc
        Implements TargetPersUniti
        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 11
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return -2
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 31
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 27
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Elite
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian426Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 4
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 5
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 27
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 6
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 34
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return -1
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Conscript
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian248Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 5
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 7
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return ConstantClassLibrary.ASLXNA.FortitudeStatus.Fanatic
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 32
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Elite
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian237Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELr As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELr = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 3
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 6
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 31
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 34
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC

        'Identifier UC 101

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when a KIA result is obtained from the IFT
        '2.	The Target drops its support weapons [UC209-TargetDropsSW]
        '3.	The Target adds CVP/CP to scenario totals [UC210-TargetAddsCVP]
        '4.	Use case ends when the Target dies [UC201-TargetDies]

        'Alternate Course A:
        'Condition:

        'Inheritance: UC 111 - SMCTargetKIAResult
        'Condition: Target is an SMC

        '            Post conditions
        '1.

        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        'Identifier UC 101

        '            Preconditions()
        '1.	An eligible IFT fire solution has produced a result

        '            Basic Course
        '1.	Use case begins when a KIA result is obtained from the IFT
        '2.	The Target drops its support weapons [UC209-TargetDropsSW]
        '3.	The Target adds CVP/CP to scenario totals [UC210-TargetAddsCVP]
        '4.	Use case ends when the Target dies [UC201-TargetDies]

        'Alternate Course A:
        'Condition:

        'Inheritance: UC 111 - SMCTargetKIAResult
        'Condition: Target is an SMC

        '            Post conditions
        '1.


        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]
        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELr) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)

        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian227Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 3
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 6
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 30
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 34
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian226Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 1
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 4
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 33
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 6
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return ConstantClassLibrary.ASLXNA.OrderStatus.Disrupted
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Conscript
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA
        myPersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian8_1Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private CheckState As UtilClassLibrary.ASLXNA.StateChecksc
        Private myHOBFlag As Boolean

        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        CheckState = New UtilClassLibrary.ASLXNA.StateChecksc
        If CheckState.ISUnitWounded(myFortitudeStatus) Then Return 7 Else Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 1006
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        If CheckState.ISUnitWounded(myFortitudeStatus) Then Return 7 Else Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 1003
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 2205
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = 1 'elite and Russian
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroicLdrHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroicLdrCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        If Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        Dim WoundCheckdr As Integer = Dieclass.Dieroll
        If Me.IsWounded Then WoundCheckdr += 1
        If WoundCheckdr <= 4 Then PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds Else PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        Return True
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        UpdateUnit.FortitudeStatus = PassTarget.BasePersUnit.FortitudeStatus
        Linqdata.QuickUpdate()
        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString
        Private Function IsWounded() As Boolean
        If Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Return True
        Else
        Return False
        End If
        End Function

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        ' If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        'End If
        ElseIf Sniperdr = 2 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        'End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian149Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 8
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return -2
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 9
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 2205
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2 - no effect, heros don't take HOB

        Dim FDR As Integer = ODR + MCNum
        If FDR <= (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        End If
        Return True
        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        UpdateUnit.FortitudeStatus = PassTarget.BasePersUnit.FortitudeStatus
        Linqdata.QuickUpdate()
        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        'End If
        ElseIf Sniperdr = 2 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        'End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class Russian138Targc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return -2
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 8
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 2205
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2 - no effect, heros don't take HOB

        Dim FDR As Integer = ODR + MCNum
        If FDR <= (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        End If
        Return True

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        UpdateUnit.FortitudeStatus = PassTarget.BasePersUnit.FortitudeStatus
        Linqdata.QuickUpdate()
        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return -1
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        'End If
        ElseIf Sniperdr = 2 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        'End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class RussianConTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myConlist As List(Of Integer)
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti, ByVal PassConUnits As List(Of Integer))
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myConlist = PassConUnits
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 1006
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 0
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return myConlist
        End Get
        Set(value As List(Of Integer))
        myConlist = value
        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        If myConlist.Count = 0 Then
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Linqdata.RemoveConFromCol(PassTarget.BasePersUnit.Unit_ID)
        'Dim UpdateUnit As DataClassLibrary.Concealment = Linqdata.GetConcealmentfromCol(PassTarget.BasePersUnit.Unit_ID)
        ''UpdateUnit.OrderStatus = Me.OrderStatus
        'PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        'UpdateUnit.CX = PassTarget.BasePersUnit.CX
        ''UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        ''UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        'UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        Linqdata.QuickUpdate()
        End If
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        'called by SniperClassLibrary.SniperC.AttackResolution
        'determines which units effected by sniper attack on concealed stack and returns impact
        'A14.23 Then, if a concealed stack is chosen as the sniper's target (either per the above Random Selection or if all units are concealed),
        'the sniper player's opponent must declare the number (only) of eligible possible targets that stack contains. If it contains none
        '(i.e., is a Dummy stack), it is automatically eliminated. If it contains one, that unit is selected. If it contains two or more,
        'the player rolls for Random Selection accordingly.
        'Are dummy units in a concealed stack with non-dummies considered Eligible Targets when rolling for RS on a sniper attack?
        'A. Yes; all the Dummies would be considered one (combined) Eligible Target.


        Dim Scencolls As ObjectClassLibrary.ASLXNA.ScenarioCollectionsc = ObjectClassLibrary.ASLXNA.ScenarioCollectionsc.GetInstance
        Dim y As Integer = 0 : Dim RandomSelectString As String = "" : Dim Selectstring As String = ""
        Dim SelItems As Boolean() : Dim TargetName As String
        Dim RandSelected = New List(Of ObjectClassLibrary.ASLXNA.PersUniti) : Dim ConUnitSelected As ObjectClassLibrary.ASLXNA.PersUniti : Dim UnittoAttack As ObjectClassLibrary.ASLXNA.PersUniti
        Dim DummyFound As Boolean = False : Dim EligibleTargets As New List(Of Integer)
        If myConlist.Count = 1 Then
        ConUnitSelected = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = myConlist.Item(0)).First
        RandSelected.Add(ConUnitSelected)
        ElseIf myConlist.Count > 1 Then
        For Each ConID As Integer In myConlist
        Dim Conitem As ObjectClassLibrary.ASLXNA.PersUniti = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = ConID).First
        If (Conitem.BasePersUnit.LOBLink >= 201 And Conitem.BasePersUnit.LOBLink <= 215) AndAlso Not DummyFound Then  'combine dummies together by only counting first dummy as eligible target and reveal ALL dummies if it is selected
        DummyFound = True
        EligibleTargets.Add(Conitem.BasePersUnit.Unit_ID)
        ElseIf Not (Conitem.BasePersUnit.LOBLink >= 201 And Conitem.BasePersUnit.LOBLink <= 215) Then
        EligibleTargets.Add(CInt(Conitem.BasePersUnit.Unit_ID))
        End If
        Next
        MessageBox.Show("Concealment contains " & EligibleTargets.Count.ToString & " 'units' ", "Sniper Attack on " & myName)
        Dim RndSel As New UtilClassLibrary.ASLXNA.RandomSelection
        If EligibleTargets.Count = 1 Then
        ConUnitSelected = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = EligibleTargets.Item(0)).First
        RandSelected.Add(ConUnitSelected)
        Else
        SelItems = RndSel.RandomSel(1, EligibleTargets.Count)
        Do Until y = EligibleTargets.Count
        If SelItems(y) = True Then  'random selected
        ConUnitSelected = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = EligibleTargets.Item(y)).First
        RandSelected.Add(ConUnitSelected)
        Selectstring &= y.ToString & " "
        End If
        y += 1
        Loop
        End If
        End If
        If RandSelected.Count = 1 Then
        UnittoAttack = RandSelected.Item(0)
        If UnittoAttack.BasePersUnit.UnitName = "con" Then TargetName = "Dummy" Else TargetName = Trim(UnittoAttack.BasePersUnit.UnitName)
        MessageBox.Show("Sniper selects target: " & TargetName)
        Else
        Dim UnitSelected As Integer = 0
        Do
        RandomSelectString = "Random Selection has chosen more than one item" & vbCrLf & vbCrLf & "Items " & Selectstring & "selected" & vbCrLf & vbCrLf & "Enter number of final selection:"
        UnitSelected = CInt(InputBox(RandomSelectString, "Selecting Target from Concealed Stack: A14.23"))
        Loop Until SelItems(UnitSelected)
        UnittoAttack = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = myConlist.Item(UnitSelected)).First
        End If
        myRandomSelected = UnittoAttack.BasePersUnit.Unit_ID
        If SelUnitIsDummy(UnittoAttack) Then Return ConstantClassLibrary.ASLXNA.PersUnitResult.RevealAllDummy
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.RevealConUnitbySniper
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        Private Function SelUnitIsDummy(ByVal UnittoAttack As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean
        Dim GetState = New UtilClassLibrary.ASLXNA.StateChecksc
        Return GetState.IsUnitDummy(UnittoAttack.BasePersUnit.LOBLink)
        End Function
        End Class
        Public Class RussianDummyTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        'Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myConlist As List(Of Integer)
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        'myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        'myConlist = PassConUnits
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 202
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return True
        End Get
        Set(value As Boolean)
        'myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 7
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 0
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))
        'myConlist = value
        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = -1 'elite
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation

        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Fanatics
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select

        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargStackLdrdrm) Then
        'breaks
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        ElseIf FDR < (MoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.Con_ID = PassTarget.BasePersUnit.Con_ID
        UpdateUnit.VisibilityStatus = PassTarget.BasePersUnit.VisibilityStatus
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        'Dim Scencolls As ObjectClassLibrary.ASLXNA.ScenarioCollectionsc = ObjectClassLibrary.ASLXNA.ScenarioCollectionsc.GetInstance
        'Dim y As Integer = 0 : Dim TotalItems As Integer = 0 : Dim RandomSelectString As String = "" : Dim Selectstring As String = ""
        'Dim SelItems As Boolean()
        'Dim RandSelected = New List(Of ObjectClassLibrary.ASLXNA.PersUniti) : Dim ConUnitSelected As ObjectClassLibrary.ASLXNA.PersUniti : Dim UnittoAttack As ObjectClassLibrary.ASLXNA.PersUniti
        'If myIsDummy Then Return ConstantClassLibrary.ASLXNA.PersUnitResult.RevealDummy
        'If myConlist.Count = 1 Then
        '    ConUnitSelected = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = myConlist.Item(0)).First
        '    RandSelected.Add(ConUnitSelected)
        'ElseIf myConlist.Count > 1 Then
        '    MessageBox.Show("Concealment contains " & myConlist.Count.ToString & " 'units' ", "Sniper Attack on " & myName)
        '    Dim RndSel As New UtilClassLibrary.ASLXNA.RandomSelection

        '    SelItems = RndSel.RandomSel(1, TotalItems)
        '    Do Until y = TotalItems
        '        If SelItems(y) = True Then  'random selected
        '            ConUnitSelected = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = myConlist.Item(y)).First
        '            RandSelected.Add(ConUnitSelected)
        '            Selectstring &= y.ToString & " "
        '        End If
        '        y += 1
        '    Loop
        'End If
        'If RandSelected.Count = 1 Then
        '    UnittoAttack = RandSelected.Item(0)
        'Else
        '    Dim UnitSelected As Integer = 0
        '    Do
        '        RandomSelectString = "Random Selection has chosen more than one item" & vbCrLf & vbCrLf & "Items " & Selectstring & "selected" & vbCrLf & vbCrLf & "Enter number of final selection:"
        '        UnitSelected = CInt(InputBox(RandomSelectString, "Selecting Target from Concealed Stack: A14.23"))
        '    Loop Until SelItems(UnitSelected)
        '    UnittoAttack = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = myConlist.Item(y)).First
        'End If
        'myRandomSelected = UnittoAttack.BasePersUnit.Unit_ID
        'Return ConstantClassLibrary.ASLXNA.PersUnitResult.RevealConUnitbySniper
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class PrisonerSquadTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 0
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 6
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        'location info needs to be updated for prisoners moving to captors hex - SHOULD THIS BE IF THEN'D?
        UpdateUnit.hexnum = CType(PassTarget.BasePersUnit.Hexnum, Short?)
        UpdateUnit.Hexname = PassTarget.BasePersUnit.Hexname
        UpdateUnit.hexlocation = PassTarget.BasePersUnit.hexlocation
        UpdateUnit.Position = PassTarget.BasePersUnit.hexPosition
        UpdateUnit.LocIndex = PassTarget.BasePersUnit.LOCIndex
        UpdateUnit.LevelinHex = PassTarget.BasePersUnit.LevelinHex
        UpdateUnit.HexEnteredSideCrossedLastMove = PassTarget.BasePersUnit.HexEntSideCrossed
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class PrisonerHalfSquadTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 0
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 6
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        'location info needs to be updated for prisoners moving to captors hex - SHOULD THIS BE IF THEN'D?
        UpdateUnit.hexnum = CType(PassTarget.BasePersUnit.Hexnum, Short?)
        UpdateUnit.Hexname = PassTarget.BasePersUnit.Hexname
        UpdateUnit.hexlocation = PassTarget.BasePersUnit.hexlocation
        UpdateUnit.Position = PassTarget.BasePersUnit.hexPosition
        UpdateUnit.LocIndex = PassTarget.BasePersUnit.LOCIndex
        UpdateUnit.LevelinHex = PassTarget.BasePersUnit.LevelinHex
        UpdateUnit.HexEnteredSideCrossedLastMove = PassTarget.BasePersUnit.HexEntSideCrossed
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class PrisonerSMCTargc
        Implements TargetPersUniti

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        'Private myCharacterStatus As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        'Private myRoleStatus As Integer
        Private mySmoke As Integer
        'Private mySw As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private myHOBFlag As Boolean
        'constructor
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        myHOBFlag = False
        End Sub

        'properties
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return myAttackedbydrm
        End Get
        Set(value As Integer)
        myAttackedbydrm = value
        End Set
        End Property

        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return myAttackedbyFP
        End Get
        Set(value As Integer)
        myAttackedbyFP = value
        End Set
        End Property

        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return 0
        End Get

        End Property

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        Return 0
        End Get

        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return myELR5
        End Get
        Set(value As Boolean)
        myELR5 = value
        End Set
        End Property

        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property

        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return 0
        End Get

        End Property

        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property

        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property

        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return False
        End Get

        End Property
        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        Return 6
        End Get
        End Property
        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property
        'Public Property RoleStatus As Integer Implements TargetPersUniti.RoleStatus
        '    Get
        '        Return myRoleStatus
        '    End Get
        '    Set(value As Integer)
        '        myRoleStatus = value
        '    End Set
        'End Property
        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return 0
        End Get

        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Firstline
        End Get

        End Property
        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        'methods
        ''Public Function CanStillUseInherentFP() As Boolean Implements TargetPersUniti.CanStillUseInherentFP

        ''End Function

        Public Function CRMC(ByVal KNum As Integer, ByVal TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        'Unit will be reduced but need to determine MC impact now. Since all HS have same ML as squads, can do so - NOT TRUE FOR BROKEN S/HS - NEED TO REDO
        Dim Ldrstring As String = ""
        If TargSTackLdrdrm = 0 Then Ldrstring = "no" Else Ldrstring = TargSTackLdrdrm.ToString
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        Dim HOBdrm As Integer = 2  'Russian
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        CurrentMoraleLevel = Me.BrokenML
        HOBdrm += 1
        Else
        CurrentMoraleLevel = Me.MoraleLevel
        End If
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + KNum
        '12
        If ODR = 12 Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesDies
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        ElseIf FDR <= (CurrentMoraleLevel - TargSTackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesPins
        ElseIf FDR > (CurrentMoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If FDR > (CurrentMoraleLevel - TargSTackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        Resultstring = " and breaks as it fails MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Resultstring = " and passes MC with " & Ldrstring & "SMC drm and a " & ODR.ToString & " dice roll"
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False
        End Function

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public Function MC(ByVal MCNum As Integer, ByVal TargStackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargStackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        CombatResultString &= myName & " rolls a " & ODR.ToString
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        'SANActivated = True
        If SANActivated Then CombatResultString &= " (SAN)"
        CombatResultString &= ": "
        Dim CurrentMoraleLevel As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then CurrentMoraleLevel = Me.BrokenML Else CurrentMoraleLevel = Me.MoraleLevel
        '2
        If ODR = 2 Then myHOBFlag = True
        'FDR
        Dim FDR As Integer = ODR + MCNum
        '12
        If ODR = 12 Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        Return True
        End If
        'MC
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesReducesBreaks
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReducesBreaks
        End If
        ElseIf FDR <= (CurrentMoraleLevel - TargStackLdrdrm) Then
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        Else
        If FDR = (CurrentMoraleLevel - TargStackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (CurrentMoraleLevel - TargStackLdrdrm) Then
        'fails MC
        If FDR > (CurrentMoraleLevel - TargStackLdrdrm + myELR) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.ReplacesDMs
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        End If
        ElseIf FDR < (CurrentMoraleLevel - TargStackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        End If
        If Not PersUnitImpact = 0 Then Return True Else Return False

        End Function

        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Function PTC(ByVal TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function
        Public Function UpdateTargetStatus(ByVal PassTarget As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        'location info needs to be updated for prisoners moving to captors hex - SHOULD THIS BE IF THEN'D?
        UpdateUnit.hexnum = CType(PassTarget.BasePersUnit.Hexnum, Short?)
        UpdateUnit.Hexname = PassTarget.BasePersUnit.Hexname
        UpdateUnit.hexlocation = PassTarget.BasePersUnit.hexlocation
        UpdateUnit.Position = PassTarget.BasePersUnit.hexPosition
        UpdateUnit.LocIndex = PassTarget.BasePersUnit.LOCIndex
        UpdateUnit.LevelinHex = PassTarget.BasePersUnit.LevelinHex
        UpdateUnit.HexEnteredSideCrossedLastMove = PassTarget.BasePersUnit.HexEntSideCrossed
        Linqdata.QuickUpdate()
        End Function
        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return 0
        End Get
        End Property

        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Reduces
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf Sniperdr = 2 Then
        If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.DMs
        Else
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC
        Dim HOBdrm As Integer = 0
        If myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or myOrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then HOBdrm += 1 'broken
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Dim HobImpact As Integer = 0
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        HobImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return HobImpact
        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        'NEED TO CREATE MORE DECORATOR CLASSES???
        'These are the decorators that wrap the Movement concrete component classes
        'via the Unit Decorator interfaces
        Public Interface MoveUnitDecoratori
        Inherits ObjectClassLibrary.ASLXNA.MovingPersuniti
        End Interface
        'Unit is DoubleTiming
        Public Class DoubleTimec
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private DTBonus As Integer = 0

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        UsingDTvalue = True : UsingRBvalue = BaseUnit.UsingRoadBonus
        mfusedvalue = BaseUnit.MFUsed
        If mfusedvalue > 0 Then DTBonus = 1 Else DTBonus = 2
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        'Dim DTBonus As Integer = 0
        'If MFUsed > 0 Then DTBonus = 1 Else DTBonus = 2
        Return DTBonus + BaseUnit.CalcMF
        End Function

        'Public Property Currenthex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Currenthex
        '    Get
        '        Return BaseUnit.Currenthex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.Currenthex = value
        '    End Set
        'End Property

        'Public Property CurrentLocationInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentLocationInHex
        '    Get
        '        Return BaseUnit.CurrentLocationInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentLocationInHex = value
        '    End Set
        'End Property

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property itemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return BaseUnit.IsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return BaseUnit.UsingRoadBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return BaseUnit.HasLdrBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property

        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property

        'Public Property CurrentPositionInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentPositionInHex
        '    Get
        '        Return BaseUnit.CurrentPositionInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentPositionInHex = value
        '    End Set
        'End Property

        'Public Property LocIndex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.LocIndex
        '    Get
        '        Return BaseUnit.LocIndex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.LocIndex = value
        '    End Set
        'End Property
        Public Property HexEnteredSideCrossed As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        'Unit is carrying
        Public Class IPCc
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private ppexcess As Integer
        Private ldraddstoIPC As Integer
        'Private MovementStacktoCheck As List(Of MovingObjecttypeinterface)
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private mfusedvalue As Single
        Private ppimpactvalue As Boolean

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti, ByVal DetermineModifiers As MovementModifiersi)
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        'MovementStacktoCheck = Game.Scenario.DoMove.MovingUnits.SelectedList
        ldraddstoIPC = 0
        'If DetermineModifiers.GetsLdrBonus Then 'does ldr add IPC to this unit?

        'End If
        ppexcess = DetermineModifiers.PPAdjust
        If ppexcess <> 0 Then ppimpactvalue = True
        UsingDTvalue = BaseUnit.UsingDT : UsingRBvalue = BaseUnit.UsingRoadBonus
        mfusedvalue = BaseUnit.MFUsed
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        'If LdrAdds() Then ldraddstoIPC = 1
        Return ppexcess + ldraddstoIPC + BaseUnit.CalcMF
        End Function

        'Public Property Currenthex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Currenthex
        '    Get
        '        Return BaseUnit.Currenthex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.Currenthex = value
        '    End Set
        'End Property

        'Public Property CurrentLocationInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentLocationInHex
        '    Get
        '        Return BaseUnit.CurrentLocationInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentLocationInHex = value
        '    End Set
        'End Property

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property
        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return BaseUnit.IsDummy
        End Get
        End Property
        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return BaseUnit.UsingDT
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return BaseUnit.UsingRoadBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property
        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return BaseUnit.HasLdrBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property
        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return ppimpactvalue
        End Get
        End Property
        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property
        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property
        'Public Property CurrentPositionInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentPositionInHex
        '    Get
        '        Return BaseUnit.CurrentPositionInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentPositionInHex = value
        '    End Set
        'End Property

        'Public Property LocIndex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.LocIndex
        '    Get
        '        Return BaseUnit.LocIndex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.LocIndex = value
        '    End Set
        'End Property
        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property
        'Methods
        ''Private Function LdrAdds() As Boolean
        ''    Dim TestModel As New MOVEC
        ''    Dim UnitswithExcessPP As Integer = 0 : Dim SMCPresent As Integer = 0
        ''    For Each MovingUnittoCheck As ObjectClassLibrary.ASLXNA.MovingPersuniti In Game.Scenario.DoMove.MovingUnits.SelectedList
        ''        Dim SWCarrying As Integer = TestModel.PPCarrying(MovingUnittoCheck)
        ''        If SWCarrying > MovingUnittoCheck.IPC Then
        ''            UnitswithExcessPP += 1
        ''        End If
        ''        Dim unittocheck As DataClassLibrary.OrderofBattle = Game.linqdata.GetUnitfromCol(MovingUnittoCheck.ItemID)
        ''        If unittocheck.IsUnitASMC And Not (unittocheck.OrderStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Or unittocheck.OrderStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        ''        unittocheck.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd Or unittocheck.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc) And SWCarrying = 0 Then
        ''            SMCPresent += 1
        ''        End If
        ''    Next
        ''    If SMCPresent = 0 Then Return False 'no SMC eligible to add IPC to units carrying excess PP
        ''    If SMCPresent >= UnitswithExcessPP Then  'SMC can add their IPC to all units carrying excess PP
        ''        Return True
        ''    Else ' need to choose which unit to add IPC to
        ''        Dim msg As String = "Do you wish to have SMC add its IPC to " & Trim(Me.OBName) & "?"
        ''        Dim title As String = "Checking IPC"
        ''        Dim style = MsgBoxStyle.YesNo Or MsgBoxStyle.DefaultButton2 Or MsgBoxStyle.Critical
        ''        ' Display the message box and save the response, Yes or No.
        ''        Dim response = MsgBox(msg, style, title)
        ''        ' Take some action based on the response.
        ''        Return If(response = MsgBoxResult.Yes, True, False)
        ''        ' can we persist this response
        ''    End If
        ''End Function

        'Public Function ConcealmentLossCheck() As Boolean Implements DataClassLibrary.ASLXNA.MovingObjecttypeinterface.ConcealmentLossCheck
        '    If Me.IsConcealed Then
        '        Dim ConLossCheck As New ConcealmentLoss
        '        Return ConLossCheck.IsLost(Me)
        '    Else
        '        Return False
        '    End If
        'End Function

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        'Unit is encircled
        Public Class Encircledc
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private MFUsedvalue As Single

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        UsingDTvalue = BaseUnit.UsingDT : UsingRBvalue = BaseUnit.UsingRoadBonus
        MFUsedvalue = BaseUnit.MFUsed
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        Return -1 + BaseUnit.CalcMF
        End Function

        'Public Property Currenthex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Currenthex
        '    Get
        '        Return BaseUnit.Currenthex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.Currenthex = value
        '    End Set
        'End Property

        'Public Property CurrentLocationInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentLocationInHex
        '    Get
        '        Return BaseUnit.CurrentLocationInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentLocationInHex = value
        '    End Set
        'End Property

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property itemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return BaseUnit.IsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return BaseUnit.HasLdrBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return MFUsedvalue
        End Get
        Set(value As Single)
        MFUsedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return BaseUnit.PPImpact
        End Get
        End Property
        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property

        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property

        'Public Property CurrentPositionInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentPositionInHex
        '    Get
        '        Return BaseUnit.CurrentPositionInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentPositionInHex = value
        '    End Set
        'End Property

        'Public Property LocIndex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.LocIndex
        '    Get
        '        Return BaseUnit.LocIndex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.LocIndex = value
        '    End Set
        'End Property
        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property
        'Public Function ConcealmentLossCheck() As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ConcealmentLossCheck
        '    If Me.IsConcealed Then
        '        Dim ConLossCheck As New ConcealmentLoss
        '        Return ConLossCheck.IsLost(Me)
        '    Else
        '        Return False
        '    End If
        'End Function

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        'Unit is using Road Bonus
        Public Class RoadBonusc
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private MFUsedvalue As Single

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        UsingDTvalue = BaseUnit.UsingDT : UsingRBvalue = True
        MFUsedvalue = BaseUnit.MFUsed
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        Return 1 + BaseUnit.CalcMF
        End Function

        'Public Property Currenthex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Currenthex
        '    Get
        '        Return BaseUnit.Currenthex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.Currenthex = value
        '    End Set
        'End Property

        'Public Property CurrentLocationInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentLocationInHex
        '    Get
        '        Return BaseUnit.CurrentLocationInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentLocationInHex = value
        '    End Set
        'End Property

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return BaseUnit.IsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return BaseUnit.HasLdrBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return MFUsedvalue
        End Get
        Set(value As Single)
        MFUsedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return BaseUnit.PPImpact
        End Get
        End Property
        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property

        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property

        'Public Property CurrentPositionInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentPositionInHex
        '    Get
        '        Return BaseUnit.CurrentPositionInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentPositionInHex = value
        '    End Set
        'End Property

        'Public Property LocIndex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.LocIndex
        '    Get
        '        Return BaseUnit.LocIndex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.LocIndex = value
        '    End Set
        'End Property
        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property
        'Public Function ConcealmentLossCheck() As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ConcealmentLossCheck
        '    If Me.IsConcealed Then
        '        Dim ConLossCheck As New ConcealmentLoss
        '        Return ConLossCheck.IsLost(Me)
        '    Else
        '        Return False
        '    End If
        'End Function

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        'Unit is moving with ldr
        Public Class LdrBonusc
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private MFUsedvalue As Single
        Private TempMovingList As List(Of ObjectClassLibrary.ASLXNA.PersUniti)

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti, ByVal Templist As List(Of ObjectClassLibrary.ASLXNA.PersUniti))
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        UsingDTvalue = BaseUnit.UsingDT : UsingRBvalue = BaseUnit.UsingRoadBonus
        MFUsedvalue = BaseUnit.MFUsed
        TempMovingList = Templist
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        If Not BaseUnit.IsDummy Then
        If BaseParent.BasePersUnit.IsUnitGreen Then  'Green with leader have 6 MF
        Return 3 + IPCAdjustment() + BaseUnit.CalcMF
        ElseIf (BaseParent.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Or BaseParent.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        BaseParent.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd Or BaseParent.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc) Or BaseParent.BasePersUnit.IsUnitASMC Then  'no ldrbonus applies
        Return BaseUnit.CalcMF
        Else  'MMC
        Return 2 + IPCAdjustment() + BaseUnit.CalcMF
        End If
        Else
        Return 2 + BaseUnit.CalcMF
        End If
        End Function

        'Public Property Currenthex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Currenthex
        '    Get
        '        Return BaseUnit.Currenthex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.Currenthex = value
        '    End Set
        'End Property

        'Public Property CurrentLocationInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentLocationInHex
        '    Get
        '        Return BaseUnit.CurrentLocationInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentLocationInHex = value
        '    End Set
        'End Property

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property ItemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return BaseUnit.IsDummy
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return UsingDTvalue
        End Get
        Set(value As Boolean)
        UsingDTvalue = value
        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return UsingRBvalue
        End Get
        Set(value As Boolean)
        UsingRBvalue = value
        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return MFUsedvalue
        End Get
        Set(value As Single)
        MFUsedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return BaseUnit.PPImpact
        End Get
        End Property

        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property

        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property

        'Public Property CurrentPositionInHex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CurrentPositionInHex
        '    Get
        '        Return BaseUnit.CurrentPositionInHex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.CurrentPositionInHex = value
        '    End Set
        'End Property
        'Public Property LocIndex As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.LocIndex
        '    Get
        '        Return BaseUnit.LocIndex
        '    End Get
        '    Set(value As Integer)
        '        BaseUnit.LocIndex = value
        '    End Set
        'End Property
        Public Property HexEnteredSideCrossed As Integer Implements MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property
        'Methods
        Private Function IPCAdjustment() As Integer
        Dim UnitswithExcessPP As Integer = 0 : Dim SMCPresent As Integer = 0
        For Each MovingUnittoCheck As ObjectClassLibrary.ASLXNA.PersUniti In TempMovingList
        If MovingUnittoCheck.MovingPersUnit.PPImpact Then
        UnitswithExcessPP += 1
        End If
        If BaseParent.BasePersUnit.IsUnitASMC And BaseParent.BasePersUnit.SW = 0 And BaseParent.BasePersUnit.FortitudeStatus <> ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded And BaseParent.BasePersUnit.FortitudeStatus <> ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd And
        BaseParent.BasePersUnit.FortitudeStatus <> ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd And BaseParent.BasePersUnit.FortitudeStatus <> ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        SMCPresent += 1
        End If
        Next
        If SMCPresent = 0 Then Return 0 'no SMC eligible to add IPC to units carrying excess PP
        If SMCPresent >= UnitswithExcessPP Then  'SMC can add their IPC to all units carrying excess PP
        Return 1
        Else ' need to choose which unit to add IPC to
        Dim msg As String = "Do you wish to have SMC add its IPC to " & Trim(Me.OBName) & "?"
        Dim title As String = "Checking IPC"
        Dim style = MsgBoxStyle.YesNo Or MsgBoxStyle.DefaultButton2 Or MsgBoxStyle.Critical
        ' Display the message box and save the response, Yes or No.
        Dim response = MsgBox(msg, style, title)
        ' Take some action based on the response.
        Return If(response = MsgBoxResult.Yes, 1, 0)
        ' can we persist this response
        End If
        End Function

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        #End Region
        #Region "MovementModifiers interface and object"
        'Provides interface and class to check various MF determinations
        Public Interface MovementModifiersi
        ReadOnly Property DoubleTiming As Boolean
        ReadOnly Property GetsLdrBonus As Boolean
        ReadOnly Property GetsRoadBonus As Boolean
        ReadOnly Property PPAdjust As Integer
        ReadOnly Property IsEncircled As Boolean
        Sub UpdateModifiers(ByVal MovingUnittoCheck As ObjectClassLibrary.ASLXNA.PersUniti, ByVal controlclick As Integer, ByVal leaderpresent As Boolean)
        'ReadOnly Property Basetype As Integer
        End Interface
        Public Class MovementModifiersc
        Implements MovementModifiersi
        Private dbltime As Boolean
        Private ldrbonus As Boolean
        Private roadbonus As Boolean
        Private ppadjustment As Integer
        Private encircled As Boolean
        'Private baseunittype As Integer
        Public Sub New()
        dbltime = False : ldrbonus = False : roadbonus = False
        End Sub
        Public Sub UpdateModifiers(ByVal MovingUnittoCheck As ObjectClassLibrary.ASLXNA.PersUniti, ByVal controlclick As Integer, ByVal leaderpresent As Boolean) Implements MovementModifiersi.UpdateModifiers

        encircled = EncircledCheck(MovingUnittoCheck)
        ppadjustment = CalculateIPCImpact(MovingUnittoCheck)
        If leaderpresent AndAlso Not (MovingUnittoCheck.BasePersUnit.IsUnitASMC) Then ldrbonus = True
        Dim CXTest As Boolean = False
        Select Case controlclick  'need to use pattern based on enum values
        Case ConstantClassLibrary.ASLXNA.UMove.DblTime, ConstantClassLibrary.ASLXNA.ContextM.DoubleTime 'Dbl Time
        'update the values
        CXTest = True
        dbltime = True
        Case ConstantClassLibrary.ASLXNA.UMove.DbT_RB  'Dbl time and road bonus
        'update the values
        CXTest = True
        dbltime = True
        roadbonus = True
        Case ConstantClassLibrary.ASLXNA.UMove.RoadBonus, ConstantClassLibrary.ASLXNA.ContextM.RoadBonus
        'update the values
        roadbonus = True
        End Select
        MovingUnittoCheck.BasePersUnit.CX = CXTest
        ''If MovingUnittoCheck.MovingPersUnit.IsDummy Then
        ''    Dim unittocheck As DataClassLibrary.Concealment = Game.linqdata.Concealcol.Where(Function(FindCol) FindCol.Con_ID = MovingUnittoCheck.ItemID).First
        ''    If CXTest Then unittocheck.CX = CXTest
        ''Else
        ''    Dim unittocheck As DataClassLibrary.OrderofBattle = Game.linqdata.GetUnitfromCol(MovingUnittoCheck.ItemID)
        ''    If CXTest Then
        ''        Dim UnittoChange As UnitChangei = New SetasCXc(unittocheck.OBUnit_ID)
        ''        UnittoChange.TakeAction()
        ''    End If
        ''End If
        'If MovingUnittoCheck.UsingDT Then dbltime = True
        'If MovingUnittoCheck.UsingRoadBonus Then roadbonus = True
        'roadbonus = PassModel.RoadmovementBonus(UnittoCheck)
        End Sub

                Public ReadOnly Property DoubleTiming As Boolean Implements MovementModifiersi.DoubleTiming
                Get
                Return (dbltime)
                End Get
                End Property

                Public ReadOnly Property GetsLdrBonus As Boolean Implements MovementModifiersi.GetsLdrBonus
                Get
                Return ldrbonus
                End Get
                End Property

                Public ReadOnly Property GetsRoadBonus As Boolean Implements MovementModifiersi.GetsRoadBonus
                Get
                Return roadbonus
                End Get
                End Property

                Public ReadOnly Property IsEncircled As Boolean Implements MovementModifiersi.IsEncircled
                Get
                Return encircled
                End Get
                End Property

                Public ReadOnly Property PPAdjust As Integer Implements MovementModifiersi.PPAdjust
                Get
                Return ppadjustment
                End Get
                End Property
                Private Function CalculateIPCImpact(ByVal MovingUnittoCheck As PersUniti) As Integer
                Dim SWCarrying As Integer = PPCarrying(MovingUnittoCheck)
                If SWCarrying > MovingUnittoCheck.MovingPersUnit.IPC Then
                Return MovingUnittoCheck.MovingPersUnit.IPC - SWCarrying
                Else
                Return 0
                End If
                End Function
                Public Function PPCarrying(ByVal MovingUnittoCheck As PersUniti) As Integer
                Dim OBSWPoss As Integer = 0 : Dim Carrying As Integer = 0
                Dim SWStatus As Integer = 0
                Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance
                If MovingUnittoCheck.MovingPersUnit.IsDummy Then
                Return 0
                Else
                For x As Integer = 1 To 2
                OBSWPoss = MovingUnittoCheck.BasePersUnit.GetSW(x)
                If OBSWPoss <> 0 Then  '0 value means no SW
        'retrieve type of SW
        Dim OBSWtype As Integer = CInt(Linqdata.GetOBSWData(ConstantClassLibrary.ASLXNA.OBSWitem.Weapontype, OBSWPoss))
        'determine if dismantled
        SWStatus = CInt(Linqdata.GetOBSWData(ConstantClassLibrary.ASLXNA.OBSWitem.Status, OBSWPoss))
        'get PP cost
        Carrying += If(SWStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dismantled Or SWStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken, CInt(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.DMPP, OBSWtype)), CInt(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.PP, OBSWtype)))
        End If
        Next
        Return Carrying
        End If
        End Function
        Public Function EncircledCheck(ByVal MovingUnittoCheck As ObjectClassLibrary.ASLXNA.PersUniti) As Boolean
        Return If(MovingUnittoCheck.BasePersUnit.IsUnitEncircled, True, False)
        End Function

        End Class
        'First level interface; all personnel unit instances will implement
        Public Interface SuppWeapi
        'all support weapons must follow this interface
        'properties
        ReadOnly Property BaseSW As BaseSuppWeapc
        Property MovingSW As MovingSuppWeapi
        Property FiringSW As FiringSuppWeapi
        'Property TargetPersUnit As TargetPersUniti
        ReadOnly Property IsMG As Boolean
        ReadOnly Property IsFT As Boolean
        ReadOnly Property IsDC As Boolean
        Function SetTexture() As String
        End Interface
        Public Class BaseSuppWeapc

        Private myScenario As Integer
        Private myHexnum As Integer
        Private myhexlocation As Integer
        Private myhexPosition As Integer
        Private myLevelinHex As Single
        Private myLOCIndex As Integer
        Private myCX As Boolean
        'Private myELR As Integer
        Private myTurnArrives As Integer
        Private myNationality As Integer
        Private myCon_ID As Integer
        Private myUnit_ID As Integer
        Private myTypeType_ID As Integer
        'Private myFirstSWLink As Integer
        'Private mySecondSWlink As Integer
        'Private mySW As Integer
        Private myHexEntSideCrossed As Integer
        Private mySolID As Integer
        Private myUnitName As String
        Private myLOBLink As Integer
        Private myMovementStatus As Integer
        Private myFortitudeStatus As Integer
        Private myOrderStatus As Integer
        Private myVisibilityStatus As Integer
        Private myCombatStatus As Integer
        Private myCharacterStatus As Integer
        Private myPinned As Boolean
        Private myPP As Integer
        Private myRepair As Integer
        Private myDisPP As Integer
        Private myCaptured As Boolean
        Private myOwner As Integer
        'Private myUnitClass As Integer

        Private pOBTexture As Microsoft.Xna.Framework.Graphics.Texture2D  'holds value of image
        'constructor
        Public Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)


        myScenario = PassScenario
        myHexnum = PassHexnum
        myhexlocation = Passhexlocation
        myhexPosition = PasshexPosition
        myLevelinHex = PassLevelinHex
        myLOCIndex = PassLOCIndex
        myCX = PassCX
        'myELR = PassELR
        myTurnArrives = PassTurnArrives
        myNationality = PassNationality
        myCon_ID = PassCon_ID
        myUnit_ID = PassUnit_ID
        myTypeType_ID = PassTypeType_ID
        'mySW = PassSW
        'myFirstSWLink = PassFirstSWLink
        'mySecondSWlink = PassSecondSWlink
        myHexEntSideCrossed = PassHexEntSideCrossed
        mySolID = PassSolID
        myUnitName = PassUnitName
        myLOBLink = PassLOBLink
        myMovementStatus = PassMovementStatus
        myFortitudeStatus = PassFortitudeStatus
        myOrderStatus = PassOrderStatus
        myVisibilityStatus = PassVisibilityStatus
        myCombatStatus = PassCombatStatus
        myPinned = PassPinned
        'myUnitClass = PassUnitClass
        myCharacterStatus = PassCharacterStatus
        myPP = PassPP
        myDisPP = PassDisPP
        myRepair = PassRepair
        myCaptured = PassCaptured
        myOwner = PassOwner
        End Sub
        'properties
        Public ReadOnly Property UnitName As String
        Get
        Return myUnitName
        End Get
        End Property

        Public ReadOnly Property Scenario As Integer
        Get
        Return myScenario
        End Get
        End Property
        Public Property Hexnum As Integer
        Get
        Return myHexnum
        End Get
        Set(value As Integer)
        myHexnum = value
        End Set
        End Property
        Public Property hexlocation As Integer
        Get
        Return myhexlocation
        End Get
        Set(value As Integer)
        myhexlocation = value
        End Set
        End Property
        Public Property hexPosition As Integer
        Get
        Return myhexPosition
        End Get
        Set(value As Integer)
        myhexPosition = value
        End Set
        End Property
        Public Property LevelinHex As Single
        Get
        Return myLevelinHex
        End Get
        Set(value As Single)
        myLevelinHex = value
        End Set
        End Property
        Public Property LOCIndex As Integer
        Get
        Return myLOCIndex
        End Get
        Set(value As Integer)
        myLOCIndex = value
        End Set
        End Property
        Public Property CX As Boolean
        Get
        Return myCX
        End Get
        Set(value As Boolean)
        myCX = value
        End Set
        End Property
        'Public Property ELR As Integer
        '    Get
        '        Return myELR
        '    End Get
        '    Set(value As Integer)
        '        myELR = value
        '    End Set
        'End Property
        Public ReadOnly Property TurnArrives As Integer
        Get
        Return myTurnArrives
        End Get
        End Property
        Public ReadOnly Property Nationality As Integer
        Get
        Return myNationality
        End Get
        End Property
        Public Property Con_ID As Integer
        Get
        Return myCon_ID
        End Get
        Set(value As Integer)
        myCon_ID = value
        End Set
        End Property
        Public ReadOnly Property Unit_ID As Integer
        Get
        Return myUnit_ID
        End Get
        End Property
        Public Property Type_ID As Integer
        Get
        Return myTypeType_ID
        End Get
        Set(value As Integer)
        myTypeType_ID = value
        End Set
        End Property
        'Public Property FirstSWLink As Integer
        '    Get
        '        Return myFirstSWLink
        '    End Get
        '    Set(value As Integer)
        '        myFirstSWLink = value
        '    End Set
        'End Property
        'Public Property SecondSWlink As Integer
        '    Get
        '        Return mySecondSWlink
        '    End Get
        '    Set(value As Integer)
        '        mySecondSWlink = value
        '    End Set
        'End Property
        Public Property HexEntSideCrossed As Integer
        Get
        Return myHexEntSideCrossed
        End Get
        Set(value As Integer)
        myHexEntSideCrossed = value
        End Set
        End Property
        Public Property SolID As Integer
        Get
        Return mySolID
        End Get
        Set(value As Integer)
        mySolID = value
        End Set
        End Property
        Public ReadOnly Property LOBLink As Integer
        Get
        Return myLOBLink
        End Get
        End Property
        Public Property FortitudeStatus As Integer
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property
        Public Property MovementStatus As Integer
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Property OrderStatus As Integer
        Get
        Return myOrderStatus
        End Get
        Set(value As Integer)
        myOrderStatus = value
        End Set
        End Property
        Public Property CombatStatus As Integer
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public Property VisibilityStatus As Integer
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Property Pinned As Boolean
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Property OBTexture As Microsoft.Xna.Framework.Graphics.Texture2D  'holds value of current image for unit
        Get
        Return pOBTexture
        End Get
        Set(ByVal value As Microsoft.Xna.Framework.Graphics.Texture2D)
        pOBTexture = value
        End Set
        End Property
        Public ReadOnly Property LeftPos(ByVal MapBtype As Integer, ByVal MapXOffset As Single, ByVal MapYOffset As Single, ByVal MapMaxcols As Integer, ByVal MapMaxrows As Integer) As Integer   'holds value of x position in current hex
        Get
        Dim MapGeoTemp = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        Return CInt(MapGeoTemp.GetCX(CInt(Me.Hexnum)) - 23)
        End Get
        End Property
        Public ReadOnly Property TopPos(ByVal MapBtype As Integer, ByVal MapXOffset As Single, ByVal MapYOffset As Single, ByVal MapMaxcols As Integer, ByVal MapMaxrows As Integer) As Integer    'holds value of y position in current hex
        Get
        Dim MapGeoTemp = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        Return CInt(MapGeoTemp.GetCY(CInt(CInt(Me.Hexnum))) - 23)
        End Get
        End Property
        Public ReadOnly Property DrawPos(ByVal MapBtype As Integer, ByVal MapXOffset As Single, ByVal MapYOffset As Single, ByVal MapMaxcols As Integer, ByVal MapMaxrows As Integer) As Microsoft.Xna.Framework.Vector2
        Get
        Dim MapGeoTemp = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        DrawPos.X = CInt(MapGeoTemp.GetCX(CInt(Me.Hexnum)) - 23)
        DrawPos.Y = CInt(MapGeoTemp.GetCY(CInt(Me.Hexnum)) - 23)
        Return DrawPos
        End Get
        End Property
        'Public Property SW As Integer
        '    Get
        '        Return mySW
        '    End Get
        '    Set(value As Integer)
        '        mySW = value
        '    End Set
        'End Property
        'Public Property UnitClass As Integer
        '    Get
        '        Return myUnitClass
        '    End Get
        '    Set(value As Integer)
        '        myUnitClass = value
        '    End Set
        'End Property
        Public Property CharacterStatus As Integer
        Get
        Return myCharacterStatus
        End Get
        Set(value As Integer)
        myCharacterStatus = value
        End Set
        End Property
        Public Property DisPP As Integer
        Get
        Return myDisPP
        End Get
        Set(value As Integer)
        myDisPP = value
        End Set
        End Property
        Public Property PP As Integer
        Get
        Return myPP
        End Get
        Set(value As Integer)
        myPP = value
        End Set
        End Property
        Public ReadOnly Property Repair As Integer
        Get
        Return myRepair
        End Get
        End Property
        Public Property Captured As Boolean
        Get
        Return myCaptured
        End Get
        Set(value As Boolean)
        myCaptured = value
        End Set
        End Property
        Public Property Owner As Integer
        Get
        Return myOwner
        End Get
        Set(value As Integer)
        myOwner = value
        End Set
        End Property
        'Methods
        Public Function IsUnitALeader() As Boolean
        Return If(Me.Type_ID >= ConstantClassLibrary.ASLXNA.Utype.LdrHero And Me.LOBLink <= ConstantClassLibrary.ASLXNA.Utype.SMC, True, False)
        End Function
        Public Function IsUnitASMC() As Boolean
        Return If(Me.Type_ID >= ConstantClassLibrary.ASLXNA.Utype.LdrHero And Me.LOBLink <= ConstantClassLibrary.ASLXNA.Utype.Commissar, True, False)
        End Function

        Public Function IsInCrestStatus() As Boolean

        End Function
        'Public Function IsUnitInexperienced() As Boolean
        '    If (myUnitClass = ConstantClassLibrary.ASLXNA.UClass.green Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.Agreen Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.Sgreen Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.ASgreen Or
        '        myUnitClass = ConstantClassLibrary.ASLXNA.UClass.Conscript Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.AConscript Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.ASConscript Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.SConscript) Then Return True Else Return False
        'End Function
        'Public Function IsUnitGreen() As Boolean
        '    If (myUnitClass = ConstantClassLibrary.ASLXNA.UClass.green Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.Agreen Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.Sgreen Or myUnitClass = ConstantClassLibrary.ASLXNA.UClass.ASgreen) Then Return True Else Return False
        'End Function
        Public Function IsUnitEncircled() As Boolean
        Return If(Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or
        Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc, True, False)
        End Function
        'Public Function GetSW(ByVal SW1or2 As Integer) As Integer
        '    'called by IFT.AddFirerUnit
        '    'returns OBSW_ID of SW possessed by firing unit, 0 if no SW possessed

        '    Select Case SW1or2
        '        Case 1
        '            GetSW = CInt(Me.FirstSWLink)
        '        Case 2
        '            GetSW = CInt(Me.SecondSWlink)
        '        Case Else
        '            GetSW = 0
        '    End Select
        '    Return GetSW
        'End Function
        Public Function HasWallAdvantage() As Boolean
        Return If(myhexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (myhexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And myhexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5), True, False)
        End Function
        Public Function WeaponIsLost() As Boolean
        'called by DroppingSW.DropIt
        'if sw dropped in certain location it is lost; handles location check and processes loss
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation) = Maptables.LocationCol
        'THIS IS NOT A GOOD METHOD; ONCE location SETTLES DOWN CONVERT THIS TO db QUERIES

        Dim IsLost As Boolean = False
        Dim IsTerrChk = New TerrainClassLibrary.ASLXNA.IsTerrain(LocationCol)
        Dim Usinghex = New TerrainClassLibrary.ASLXNA.LevelChecks(LocationCol)
        Dim Baseloc As MapDataClassLibrary.GameLocation = Usinghex.GetLocationatLevelInHex(CInt(Me.Hexnum), 0)
        Dim Basehexloc As Integer = Baseloc.Location
        If IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.Marshtype) Then
        IsLost = True
        ElseIf IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.ShallowStreamtype) Then
        IsLost = True
        ElseIf IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.DeepStreamtype) Then
        IsLost = True
        ElseIf IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.WaterObstacletype) Then
        IsLost = True
        ElseIf IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.Blazetype) Then
        IsLost = True
        ElseIf IsTerrChk.IsLocationTerrainA(CInt(Me.Hexnum), CInt(Me.hexlocation), ConstantClassLibrary.ASLXNA.Location.bridgetype) And
        (CInt(Me.hexlocation) = ConstantClassLibrary.ASLXNA.Location.BeneathBridge Or (CInt(Me.hexlocation) < ConstantClassLibrary.ASLXNA.Location.StBr14 And CInt(Me.hexlocation) > ConstantClassLibrary.ASLXNA.Location.FoBr)) Then
        ' if not on bridge then check it is a water hex
        If Basehexloc >= ConstantClassLibrary.ASLXNA.Location.StBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.FoBr Then 'or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.OShSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.BrShSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.CaStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.PoFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.DeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.FlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.ODeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.OFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.WDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.WFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.PWDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.PWFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.BrDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IShSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IOShSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IBrShSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.ICaStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IPoFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IODeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IOFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IWDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IWFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IPWDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IPWFlSFoBr Or
        'Basehexloc >= ConstantClassLibrary.ASLXNA.Location.IBrDeSStBr14 And Basehexloc <= ConstantClassLibrary.ASLXNA.Location.IBrFlSFoBr Then
        IsLost = True
        End If
        ElseIf CInt(Me.hexlocation) = ConstantClassLibrary.ASLXNA.Location.BeneathPier And Basehexloc = ConstantClassLibrary.ASLXNA.Location.Pier Then
        IsLost = True
        End If
        If IsLost Then
        Me.Owner = 0
        Me.OrderStatus = CShort(ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned)
        MessageBox.Show(Trim(Me.UnitName) & " is lost and removed due to location")
        Return True
        Else
        Return False
        End If
        End Function
        End Class
        Public Interface MovingSuppWeapi

        End Interface
        Public Interface FiringSuppWeapi
        'ReadOnly Property SolID() As Integer
        'ReadOnly Property Type() As Integer
        'ReadOnly Property LOBLink() As Integer
        Property CombatStatus() As Integer
        ReadOnly Property IsCX As Boolean
        ReadOnly Property IsEncirc As Boolean
        ReadOnly Property BaseFP() As Integer
        ReadOnly Property BaseRange() As Integer
        ReadOnly Property AssF() As Boolean
        ReadOnly Property CombatFP() As Double
        ReadOnly Property LdrDRM() As Integer
        Property UseHeroOrLeader() As Integer
        Property IsPinned As Boolean
        ReadOnly Property HeroDRM() As Integer
        Property Malfunction As Integer
        ReadOnly Property ROF As Integer
        Property Breakdown As Integer
        Property SprayFire As Boolean
        ReadOnly Property IsMG() As Boolean
        'ReadOnly Property UsingInHerentFP As Boolean
        'ReadOnly Property UsingfirstMG As Boolean
        'ReadOnly Property UsingsecondMG As Boolean
        'ReadOnly Property Owner As Integer
        'Property FiringMGs As List(Of SuppWeapi)
        'Sub GetUnitRangeFPAssF(ByVal myloblink As Integer)
        'Sub GetMGRangeFPAssF(ByVal myloblink As Integer)
        Sub RangeModification(ByVal range As Single, ByVal LevelDifference As Single, ByVal TargetU As ObjectClassLibrary.ASLXNA.PersUniti)
        Sub PinnedModification()
        Sub AdvancingFireModification(ByVal Phase As Integer)
        Sub FireVsConcealedModification(ByVal TargetUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        Sub FirstFireModification()
        Sub SprayFireModification(ByVal UsingSprayFire As Boolean)
        Sub AssaultFireModification(ByVal Phase As Integer)
        Sub AreaFireModification(ByVal FGSize As Integer, ByVal targloc As MapDataClassLibrary.GameLocation)
        'Sub MGModification()
        Sub CrestStatusModification(ByVal Targethexnum As Integer)
        Sub ResetCombatFP()
        Sub UpdateCombatStatus(ByVal NewCombatStatus As Integer, ByVal ROFdr As Integer)
        'Function CanStillUseInherentFP(ByVal MGCount As Integer) As Boolean
        End Interface
        Public Class GermanLMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanMMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanHMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename





        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If
        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanFTc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return True
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanDCHc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return True
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"  'Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanRADc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanPHNc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanATRc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanPSKc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanM50c
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property
        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Gecon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class GermanLMGFiringc
        Implements FiringSuppWeapi
        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 3
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 8
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 1
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class GermanMMGfiringc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 5
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 12
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 2
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class germanHMGFiringc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 7
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 16
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 3
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class germanRadFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanPSKFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanFTFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanDCHFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanATRFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanM50Firingc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class germanPHNFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class

        Public Class RussianLMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianMMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianHMGc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename





        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If
        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianHMG50c
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename





        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Malfunctioned Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Brokendown Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokenSWImage, CInt(Me.myBaseSW.LOBLink)))
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.Dis_Broken Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.BrokemDMSWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.SWStatus.GoodOrderSW Then
        UnitTexture = CStr(Linqdata.GetLOBSWData(ConstantClassLibrary.ASLXNA.LOBItem.SWImage, CInt(Me.myBaseSW.LOBLink)))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If
        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianFTc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return True
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianDCHc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return True
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianRADc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianPHNc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianATRc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianMolPc
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property

        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianM50c
        Implements SuppWeapi

        'encapsulation variables
        Private myBaseSW As BaseSuppWeapc
        Private myMovingSW As MovingSuppWeapi
        Private myFiringSW As FiringSuppWeapi
        'Private myTargetPU As TargetPersUniti

        Sub New(ByVal PassScenario As Integer, ByVal PassHexnum As Integer, ByVal Passhexlocation As Integer, ByVal PasshexPosition As Integer, ByVal PassLevelinHex As Single, ByVal PassLOCIndex As Integer, ByVal PassCX As Boolean,
        ByVal PassTurnArrives As Integer, ByVal PassNationality As Integer, ByVal PassCon_ID As Integer, ByVal PassUnit_ID As Integer, ByVal PassTypeType_ID As Integer, ByVal PassPP As Integer, ByVal PassRepair As Integer, ByVal PassDisPP As Integer,
        ByVal PassHexEntSideCrossed As Integer, ByVal PassSolID As Integer, ByVal PassUnitName As String, ByVal PassLOBLink As Integer, ByVal PassCombatStatus As Integer, ByVal PassVisibilityStatus As Integer, ByVal PassFortitudeStatus As Integer,
        ByVal PassOrderStatus As Integer, ByVal PassMovementStatus As Integer, ByVal PassPinned As Boolean, ByVal PassSW As Integer, ByVal PassCharacterStatus As Integer, ByVal PassCaptured As Boolean, ByVal PassOwner As Integer)
        'myBasePU must be created by constructor - it has to exist, so readonly to prevent disposal
        myBaseSW = New BaseSuppWeapc(PassScenario, PassHexnum, Passhexlocation, PasshexPosition, PassLevelinHex, PassLOCIndex, PassCX, PassTurnArrives, PassNationality, PassCon_ID, PassUnit_ID, PassTypeType_ID, PassPP, PassRepair, PassDisPP,
        PassHexEntSideCrossed, PassSolID, PassUnitName, PassLOBLink, PassCombatStatus, PassVisibilityStatus, PassFortitudeStatus, PassOrderStatus, PassMovementStatus, PassPinned, PassSW, PassCharacterStatus, PassCaptured, PassOwner)

        End Sub

        Public ReadOnly Property Basesw As BaseSuppWeapc Implements SuppWeapi.BaseSW
        Get
        Return myBaseSW
        End Get
        End Property
        'these properties are populated as required by game actions
        Public Property FiringSW As FiringSuppWeapi Implements SuppWeapi.FiringSW
        Get
        Return myFiringSW
        End Get
        Set(value As FiringSuppWeapi)
        myFiringSW = value
        End Set
        End Property

        Public Property MovingSW As MovingSuppWeapi Implements SuppWeapi.MovingSW
        Get
        Return myMovingSW
        End Get
        Set(value As MovingSuppWeapi)
        myMovingSW = value
        End Set
        End Property
        Public ReadOnly Property IsDC As Boolean Implements SuppWeapi.IsDC
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsFT As Boolean Implements SuppWeapi.IsFT
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property IsMG As Boolean Implements SuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        'Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit
        '    Get
        '        Return myTargetPU
        '    End Get
        '    Set(value As TargetPersUniti)
        '        myTargetPU = value
        '    End Set
        'End Property
        'methods
        Public Function SetTexture() As String Implements SuppWeapi.SetTexture
        'called by UnitActions.New
        'sets texture property for each Unit in the scenario
        'can be nothing; if so then Game.Draw will not draw
        'Dim UnitTexture As New DataClassLibrary.ManageTexture
        'Dim texturename As String = UnitTexture.GetTexture(Me)
        'Return texturename


        'passes the unit for which a bmp needs to be found
        'content directory set in Game.New
        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If Me.myBaseSW.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Then
        UnitTexture = Nothing
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBaseSW.LOBLink))
        'If Me.myBasePU.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        ElseIf Me.myBaseSW.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        ElseIf Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(Me.myBaseSW.LOBLink))
        'If Unititem.LOBLink >= 1000 Or CInt(Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.UnitType, CInt(Unititem.LOBLink))) = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Unititem.Nationality), NatPre)) & Trim(UnitTexture)
        'End If
        Else
        'UnitTexture =
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If

        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case Me.myBaseSW.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or Me.myBaseSW.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If Me.myBaseSW.CX = True Then Unittexture &= "cx"
        If Me.myBaseSW.Pinned Then Unittexture &= "pin"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If Me.myBaseSW.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If Me.myBaseSW.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (Me.myBaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And Me.myBaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        End Class
        Public Class RussianLMGFiringc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 2
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 7
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 1
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class RussianMMGfiringc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 4
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 10
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 2
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class RussianHMGFiringc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 6
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 12
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 3
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class RussianHMG50Firingc
        Implements FiringSuppWeapi

        Private myCombatStatus As Integer
        Private myCombatFP As Double
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.SuppWeapi
        Public Sub New(ByVal PassSW As ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassSW.BaseSW.LOCIndex))
        myBaseUnit = PassSW
        End Sub
        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire

        'If Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire Then myCombatFP = myCombatFP + 1
        'MsgBox("Using Assault Fire Capability", , "Assault Fire raises FP to " & Str$(Int(myCombatFP)))
        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get
        Return 8
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get
        Return 16
        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If Not myBaseUnit.BaseSW.IsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myBaseUnit.BaseSW.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myBaseUnit.BaseSW.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myBaseUnit.BaseSW.hexPosition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get
        Return myBaseUnit.BaseSW.CX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get
        Return myBaseUnit.BaseSW.IsUnitEncircled
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned
        Get
        Return myBaseUnit.BaseSW.Pinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range

        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get
        Return 3
        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire
        Get
        Return True
        End Get
        Set(value As Boolean)

        End Set
        End Property


        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on use of Spraying Fire
        If UsingSprayFire = True Then
        myCombatFP = myCombatFP / 2
        'MsgBox(String.Format("Spraying Fire reduces {0} FP to {1}", Trim(Me.Name), CStr(myCombatFP)))
        End If
        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateSW As DataClassLibrary.OrderofBattleSW = Linqdata.GetOBSWRecord(myBaseUnit.BaseSW.Unit_ID)
        UpdateSW.CombatStatus = Me.CombatStatus
        myBaseUnit.BaseSW.CombatStatus = Me.CombatStatus
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return True
        End Get
        End Property
        End Class
        Public Class RussianRadFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianMolPFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianFTFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianDCHFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianATRFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianM50Firingc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        Public Class RussianPHNFiringc
        Implements FiringSuppWeapi

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringSuppWeapi.AdvancingFireModification

        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringSuppWeapi.AreaFireModification

        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringSuppWeapi.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringSuppWeapi.AssF
        Get

        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringSuppWeapi.BaseFP
        Get

        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringSuppWeapi.BaseRange
        Get

        End Get
        End Property

        Public Property Breakdown As Integer Implements FiringSuppWeapi.Breakdown

        Public ReadOnly Property CombatFP As Double Implements FiringSuppWeapi.CombatFP
        Get

        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringSuppWeapi.CombatStatus

        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringSuppWeapi.CrestStatusModification

        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringSuppWeapi.FireVsConcealedModification

        End Sub

        Public Sub FirstFireModification() Implements FiringSuppWeapi.FirstFireModification

        End Sub

        Public ReadOnly Property HeroDRM As Integer Implements FiringSuppWeapi.HeroDRM
        Get

        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringSuppWeapi.IsCX
        Get

        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringSuppWeapi.IsEncirc
        Get

        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringSuppWeapi.IsPinned

        Public ReadOnly Property LdrDRM As Integer Implements FiringSuppWeapi.LdrDRM
        Get

        End Get
        End Property

        Public Property Malfunction As Integer Implements FiringSuppWeapi.Malfunction

        Public Sub PinnedModification() Implements FiringSuppWeapi.PinnedModification

        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringSuppWeapi.RangeModification

        End Sub

        Public Sub ResetCombatFP() Implements FiringSuppWeapi.ResetCombatFP

        End Sub

        Public ReadOnly Property ROF As Integer Implements FiringSuppWeapi.ROF
        Get

        End Get
        End Property

        Public Property SprayFire As Boolean Implements FiringSuppWeapi.SprayFire

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringSuppWeapi.SprayFireModification

        End Sub

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringSuppWeapi.UpdateCombatStatus

        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringSuppWeapi.UseHeroOrLeader

        Public ReadOnly Property IsMG As Boolean Implements FiringSuppWeapi.IsMG
        Get
        Return False
        End Get
        End Property
        End Class
        'Decorator section for persunits
        'interfaces
        Public Interface PersunitDecoratori
        Inherits PersUniti

        Property BaseUnit As ObjectClassLibrary.ASLXNA.PersUniti
        End Interface
        Public Interface BaseUnitDecoratori
        Inherits ObjectClassLibrary.ASLXNA.Basepersuniti
        End Interface
        Public Interface TargetUnitDecoratori
        Inherits TargetPersUniti

        End Interface
        Public Interface FireUnitDecoratori
        Inherits FiringPersUniti

        End Interface
        'concrete decorator classes
        Public Class PersunitHeroicldrc
        Implements PersunitDecoratori

        Public Property BaseUnit As ObjectClassLibrary.ASLXNA.PersUniti Implements PersunitDecoratori.BaseUnit
        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        BaseUnit = PassParentUnit

        End Sub
        Public Property BasePersUnit As Basepersuniti Implements PersUniti.BasePersUnit

        Public Property FiringPersUnit As FiringPersUniti Implements PersUniti.FiringPersUnit

        Public Property MovingPersUnit As MovingPersuniti Implements PersUniti.MovingPersUnit
        Public Property TargetPersUnit As TargetPersUniti Implements PersUniti.TargetPersUnit

        Public Function SetTexture() As String Implements PersUniti.SetTexture
        'called by
        'sets texture property for persuniti
        'can be nothing; if so then Game.Draw will not draw
        'content directory set in Game.New

        'Const NatPre As Integer = 2
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim UnitTexture As String = Nothing
        If BasePersUnit.Hexnum = 0 Then  'unit is not yet onboard so don't set texture
        UnitTexture = Nothing
        ElseIf BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.KIAInf Or BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.NotInPlay Or BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Hidden Or
        BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then
        UnitTexture = "Rucon"
        'ElseIf Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.myBasePU.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        '    UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(Me.myBasePU.LOBLink))
        '    UnitTexture = Trim(Linqdata.GetNatInfo(CInt(Me.myBasePU.Nationality), NatPre)) & Trim(UnitTexture)

        ElseIf BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.GoodOrder Then
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageUnit, CInt(BasePersUnit.LOBLink))
        UnitTexture = "ru" & Trim(UnitTexture)
        Else
        UnitTexture = Linqdata.GetLOBData(ConstantClassLibrary.ASLXNA.LOBItem.ImageBrkUnit, CInt(BasePersUnit.LOBLink))
        UnitTexture = "ru" & Trim(UnitTexture)
        End If

        If IsNothing(UnitTexture) Then
        Return Nothing
        Else
        'UnitTexture needs to be just the rootname with no previous status addition, ie 667s not 667scx
        UnitTexture = Trim(UnitTexture)
        UnitTexture = StatusCheck(UnitTexture)
        Return UnitTexture
        'Return Game.Content.Load(Of Texture2D)(Trim(UnitTexture))
        End If
        End Function
        Private Function StatusCheck(ByVal Unittexture As String) As String
        'called by ManageTexture.GetTexture
        'creates texture string by checking the various status properties
        Select Case BasePersUnit.CombatStatus
        Case ConstantClassLibrary.ASLXNA.CombatStatus.PrepFirer
        Unittexture &= "prep"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.AdvFirer
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FinalFirer
        Unittexture &= "final"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Firing
        Case ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer
        Unittexture &= "first"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.Melee
        Case ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer
        Unittexture &= "opp"
        Case ConstantClassLibrary.ASLXNA.CombatStatus.SubsequentFirstFiring
        End Select
        If BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.DisruptedDM Then Unittexture &= "dm"
        If IsWounded(BasePersUnit.FortitudeStatus) Then Unittexture &= "wnd" ' = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Then Unittexture &= "wnd"
        If BasePersUnit.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.TI Then Unittexture &= "ti"
        If BasePersUnit.CX = True Then Unittexture &= "cx"
        If BasePersUnit.Pinned Then Unittexture &= "pin"
        If BasePersUnit.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour1 Then Unittexture &= "tilab1"
        If BasePersUnit.MovementStatus = ConstantClassLibrary.ASLXNA.MovementStatus.Labour2 Then Unittexture &= "tilab2"
        If BasePersUnit.hexPosition = ConstantClassLibrary.ASLXNA.AltPos.WallAdv Or (BasePersUnit.hexPosition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And BasePersUnit.hexPosition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5) Then Unittexture &= "wa"
        Return Unittexture
        End Function
        Private Function IsWounded(ByVal FortitudeStatus As Integer) As Boolean
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.HeroicWounded Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.HeroicEnc_Wnd Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.HeroicFan_Wnd Then Return True
        If FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.HeroicFan_Wnd_Enc Then Return True
        Return False

        End Function
        End Class
        Public Class TargetHeroicLdrc
        Implements TargetUnitDecoratori

        Private myFirerSAN As Integer
        Private myAttackedbydrm As Integer
        Private myAttackedbyFP As Integer
        Private myELR5 As Boolean
        Private myFortitudeStatus As Integer
        Private myIFTResult As Integer
        Private myIsConceal As Boolean
        Private myIsDummy As Boolean
        Private myMovementStatus As Integer
        Private myOrderStatus As Integer
        Private myPinned As Boolean
        Private myQualityStatus As Integer
        Private myRandomSelected As Integer
        Private mySmoke As Integer
        Private myVisibilityStatus As Integer
        Private myPersUnitImpact As Integer
        Private mySanActivated As Boolean
        Private myIFTResolved As Boolean
        Private myELR As Integer
        Private myName As String
        Private myMCNum As Integer
        Private myTargSTackLdrdrm As Integer
        Private BaseUnit As ObjectClassLibrary.ASLXNA.TargetPersUniti
        Private CheckState As UtilClassLibrary.ASLXNA.StateChecksc
        Private myHOBFlag As Boolean
        'constructor - overloaded to handle different points of construction: new during play from leader unit; at startup from existing leaderhero
        Public Sub New(ByVal PassTargetUnit As ObjectClassLibrary.ASLXNA.TargetPersUniti) 'creating from a leader
        'BaseParent = PassParentUnit
        BaseUnit = PassTargetUnit
        End Sub
        Public Sub New(ByVal PassIFTResult As Integer, ByVal TargStackLdrdrm As Integer, ByVal PassFirerSan As Integer, ByVal PassAttackedbydrm As Integer, ByVal PassAttackedbyFP As Integer, ByVal PassELR5 As Boolean,
        ByVal PassIsConceal As Boolean, ByVal PassIsDummy As Boolean, ByVal PassPinned As Boolean, ByVal PassQualityStatus As Integer, ByVal PassRandomSelected As Integer,
        ByVal PassSmoke As Integer, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        'part of existing ldrhero instance
        myFirerSAN = PassFirerSan
        myAttackedbydrm = PassAttackedbydrm
        myAttackedbyFP = PassAttackedbyFP
        'myCharacterStatus = PassCharacterStatus
        myELR5 = PassELR5
        myFortitudeStatus = PassUnit.BasePersUnit.FortitudeStatus
        myIFTResult = PassIFTResult
        myIsConceal = PassIsConceal
        myIsDummy = PassIsDummy
        myMovementStatus = PassUnit.BasePersUnit.MovementStatus
        myOrderStatus = PassUnit.BasePersUnit.OrderStatus
        myPinned = PassPinned
        myQualityStatus = PassQualityStatus
        myRandomSelected = PassRandomSelected
        'myRoleStatus = PassRoleStatus
        mySmoke = PassSmoke
        'mySw = PassSW
        myVisibilityStatus = PassUnit.BasePersUnit.VisibilityStatus
        myPersUnitImpact = 0
        mySanActivated = False
        myIFTResolved = False
        myELR = PassUnit.BasePersUnit.ELR
        myName = Trim(PassUnit.BasePersUnit.UnitName)
        BaseUnit = PassUnit.TargetPersUnit
        myHOBFlag = False
        End Sub
        Public Property Attackedbydrm As Integer Implements TargetPersUniti.Attackedbydrm
        Get
        Return BaseUnit.Attackedbydrm
        End Get
        Set(value As Integer)
        BaseUnit.Attackedbydrm = value
        End Set
        End Property
        Public Property AttackedbyFP As Integer Implements TargetPersUniti.AttackedbyFP
        Get
        Return BaseUnit.AttackedbyFP
        End Get
        Set(value As Integer)
        BaseUnit.AttackedbyFP = value
        End Set
        End Property
        Public ReadOnly Property BPV As Integer Implements TargetPersUniti.BPV
        Get
        Return BaseUnit.BPV
        End Get
        End Property

        Public Function Break() As Boolean Implements TargetPersUniti.Break

        End Function

        Public ReadOnly Property BrokenML As Integer Implements TargetPersUniti.BrokenML
        Get
        CheckState = New UtilClassLibrary.ASLXNA.StateChecksc
        If CheckState.ISUnitWounded(myFortitudeStatus) Then
        If BaseUnit.BrokenML > 8 Then Return BaseUnit.BrokenML Else Return 8
        End If
        If BaseUnit.BrokenML > 9 Then Return BaseUnit.BrokenML Else Return 9
        End Get
        End Property
        Public Property MCNumber As Integer Implements TargetPersUniti.MCNumber
        Get
        Return myMCNum
        End Get
        Set(value As Integer)
        myMCNum = value
        End Set
        End Property
        Public Property TargStackLeaderDRM As Integer Implements TargetPersUniti.TargStackLeaderDRM
        Get
        Return myTargSTackLdrdrm
        End Get
        Set(value As Integer)
        myTargSTackLdrdrm = value
        End Set
        End Property
        Public Property CombatResultString As String Implements TargetPersUniti.CombatResultString
        Get
        Return BaseUnit.CombatResultString
        End Get
        Set(value As String)
        BaseUnit.CombatResultString = value
        End Set
        End Property

        Public Property ConcealedUnits As List(Of Integer) Implements TargetPersUniti.ConcealedUnits
        Get
        Return Nothing
        End Get
        Set(value As List(Of Integer))

        End Set
        End Property
        Public Function CRMC(KNum As Integer, TargSTackLdrdrm As Integer, ByRef Resultstring As String) As Boolean Implements TargetPersUniti.CRMC
        myMCNum = KNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        End Function

        Public Property ELR5 As Boolean Implements TargetPersUniti.ELR5
        Get
        Return False
        End Get
        Set(value As Boolean)
        myELR5 = False
        End Set
        End Property
        Public Property FirerSan As Integer Implements TargetPersUniti.FirerSan
        Get
        Return myFirerSAN
        End Get
        Set(value As Integer)
        myFirerSAN = value
        End Set
        End Property
        Public Property FortitudeStatus As Integer Implements TargetPersUniti.FortitudeStatus
        Get
        Return myFortitudeStatus
        End Get
        Set(value As Integer)
        myFortitudeStatus = value
        End Set
        End Property
        Public ReadOnly Property HardTo As Integer Implements TargetPersUniti.HardTo
        Get
        Return BaseUnit.HardTo + 120
        End Get
        End Property

        Public Function HasFT() As Boolean Implements TargetPersUniti.HasFT

        End Function

        Public Function HasWallAdvantage() As Boolean Implements TargetPersUniti.HasWallAdvantage

        End Function

        Public Property IFTResolved As Boolean Implements TargetPersUniti.IFTResolved
        Get
        Return myIFTResolved
        End Get
        Set(value As Boolean)
        myIFTResolved = value
        End Set
        End Property
        Public Property IFTResult As Integer Implements TargetPersUniti.IFTResult
        Get
        Return myIFTResult
        End Get
        Set(value As Integer)
        myIFTResult = value
        End Set
        End Property
        Public Property IsConceal As Boolean Implements TargetPersUniti.IsConceal
        Get
        Return myIsConceal
        End Get
        Set(value As Boolean)
        myIsConceal = value
        End Set
        End Property
        Public Property IsDummy As Boolean Implements TargetPersUniti.IsDummy
        Get
        Return False
        End Get
        Set(value As Boolean)
        myIsDummy = False
        End Set
        End Property

        Public ReadOnly Property IsLeader As Boolean Implements TargetPersUniti.IsLeader
        Get
        Return True
        End Get
        End Property

        Public Function KIA() As Boolean Implements TargetPersUniti.KIA

        End Function

        Public ReadOnly Property LdrDRM As Integer Implements TargetPersUniti.LdrDRM
        Get
        Return BaseUnit.LdrDRM
        End Get
        End Property

        Public Function MC(MCNum As Integer, TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.MC
        'UC
        '1.	Use case begins when MC result is obtained on the IFT
        '2.	Determine ML, ldr drm, MC# drm
        '3. Dice Roll & Snipercheck
        '4.	Determine Result (2or12, pass, pin, broken, broken > ELR)
        '5.	If  rolls 2or12 then target takes TargetHOBResult [UC 109]
        '6.	If Passes then no effect
        '7.	If Pins then Target Pins [UC206-TargetPins]
        '8.	If Breaks by <= ELR then Target Breaks [UC205-TargetBreaks] then DMs [UC208-TargetDMs]
        '9.	If Breaks by > ELR then
        'Target replaces [UC204-TargetReplaces] (Alternate Course A: UC218-TargetDisrupts, Alternate Course B: UC214-TargetSubstitutes)
        '	Target DMs [UC208-TargetDMs]

        myMCNum = MCNum
        myTargSTackLdrdrm = TargSTackLdrdrm
        Dim Dieclass = New UtilClassLibrary.ASLXNA.DiceC
        Dim ODR As Integer = Dieclass.Diceroll
        'sniper
        SANActivated = If(ODR = myFirerSAN, True, False)
        SANActivated = True
        '2
        If ODR = 2 Then
        Dim HOBdrm As Integer = 1 'elite and Russian
        Dim HOB = New UtilClassLibrary.ASLXNA.HOBCheck
        Dim HOBRes As Integer = HOB.GetHOBOutcome(HOBdrm)
        Select Case HOBRes
        Case ConstantClassLibrary.ASLXNA.HOBResult.HardensAndHero
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroicLdrHardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.HeroCreation
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.HeroicLdrCreation
        Case ConstantClassLibrary.ASLXNA.HOBResult.Hardens
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Hardens
        Case ConstantClassLibrary.ASLXNA.HOBResult.Berserk
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Berserks
        Case ConstantClassLibrary.ASLXNA.HOBResult.Surrenders
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Surrenders
        End Select
        Return True
        End If
        Dim FDR As Integer = ODR + MCNum
        If FDR = (MoraleLevel - TargSTackLdrdrm) Then 'pin result
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        ElseIf FDR > (MoraleLevel - TargSTackLdrdrm) Then
        'breaks
        If Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Or Me.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Then
        Dim WoundCheckdr As Integer = Dieclass.Dieroll
        If Me.IsWounded Then WoundCheckdr += 1
        If WoundCheckdr <= 4 Then PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds Else PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        Else
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        End If
        ElseIf FDR < (MoraleLevel - TargSTackLdrdrm) Then
        PersUnitImpact = ConstantClassLibrary.ASLXNA.PersUnitResult.NoEffects
        End If
        Return True
        End Function

        Public ReadOnly Property MoraleLevel As Integer Implements TargetPersUniti.MoraleLevel
        Get
        CheckState = New UtilClassLibrary.ASLXNA.StateChecksc
        If CheckState.ISUnitWounded(myFortitudeStatus) Then
        If BaseUnit.MoraleLevel > 8 Then Return BaseUnit.MoraleLevel Else Return 8
        End If
        If BaseUnit.MoraleLevel > 9 Then Return BaseUnit.MoraleLevel Else Return 9
        End Get
        End Property

        Public Property MovementStatus As Integer Implements TargetPersUniti.MovementStatus
        Get
        Return myMovementStatus
        End Get
        Set(value As Integer)
        myMovementStatus = value
        End Set
        End Property
        Public Function NR() As Boolean Implements TargetPersUniti.NR

        End Function

        Public Property OrderStatus As Integer Implements TargetPersUniti.OrderStatus
        Get
        Return BaseUnit.OrderStatus
        End Get
        Set(value As Integer)
        BaseUnit.OrderStatus = value
        End Set
        End Property
        Public Property PersUnitImpact As Integer Implements TargetPersUniti.PersUnitImpact
        Get
        Return myPersUnitImpact
        End Get
        Set(value As Integer)
        myPersUnitImpact = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements TargetPersUniti.Pinned
        Get
        Return myPinned
        End Get
        Set(value As Boolean)
        myPinned = value
        End Set
        End Property
        Public Function PTC(TargSTackLdrdrm As Integer) As Boolean Implements TargetPersUniti.PTC

        End Function

        Public Property QualityStatus As Integer Implements TargetPersUniti.QualityStatus
        Get
        Return myQualityStatus
        End Get
        Set(value As Integer)
        myQualityStatus = value
        End Set
        End Property
        Public Property RandomSelected As Integer Implements TargetPersUniti.RandomSelected
        Get
        Return myRandomSelected
        End Get
        Set(value As Integer)
        myRandomSelected = value
        End Set
        End Property
        Public ReadOnly Property RedTo As Integer Implements TargetPersUniti.RedTo
        Get
        Return 0
        End Get
        End Property

        Public Property SANActivated As Boolean Implements TargetPersUniti.SANActivated
        Get
        Return mySanActivated
        End Get
        Set(value As Boolean)
        mySanActivated = value
        End Set
        End Property
        Public Function SetTexture() As Integer Implements TargetPersUniti.SetTexture

        End Function

        Public Property Smoke As Integer Implements TargetPersUniti.Smoke
        Get
        Return mySmoke
        End Get
        Set(value As Integer)
        mySmoke = value
        End Set
        End Property
        Public ReadOnly Property SubTo As Integer Implements TargetPersUniti.SubTo
        Get
        Return BaseUnit.SubTo + 120
        End Get
        End Property

        Public ReadOnly Property UnitClass As Integer Implements TargetPersUniti.UnitClass
        Get
        Return 2205
        End Get
        End Property

        Public Function UpdateTargetStatus(PassTarget As PersUniti) As Boolean Implements TargetPersUniti.UpdateTargetStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassTarget.BasePersUnit.Unit_ID)
        UpdateUnit.OrderStatus = Me.OrderStatus
        PassTarget.BasePersUnit.OrderStatus = Me.OrderStatus
        UpdateUnit.CX = PassTarget.BasePersUnit.CX
        UpdateUnit.Pinned = PassTarget.BasePersUnit.Pinned
        UpdateUnit.CombatStatus = PassTarget.BasePersUnit.CombatStatus
        UpdateUnit.MovementStatus = PassTarget.BasePersUnit.MovementStatus
        UpdateUnit.FirstSWLink = CType(PassTarget.BasePersUnit.FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(PassTarget.BasePersUnit.SecondSWlink, Short?)
        UpdateUnit.SW = CType(PassTarget.BasePersUnit.SW, Short?)
        UpdateUnit.FortitudeStatus = PassTarget.BasePersUnit.FortitudeStatus
        Linqdata.QuickUpdate()
        End Function

        Public Property VisibilityStatus As Integer Implements TargetPersUniti.VisibilityStatus
        Get
        Return myVisibilityStatus
        End Get
        Set(value As Integer)
        myVisibilityStatus = value
        End Set
        End Property
        Private Function IsWounded() As Boolean
        If Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Wounded Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd Or Me.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Return True
        Else
        Return False
        End If
        End Function

        Public Function SniperImpact(Sniperdr As Integer) As Integer Implements TargetPersUniti.SniperImpact
        If Sniperdr = 1 Then
        ' If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Dies
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Breaks
        'End If
        ElseIf Sniperdr = 2 Then
        'If OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken_DM Or OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Broken Then
        Return ConstantClassLibrary.ASLXNA.PersUnitResult.Wounds
        'Else
        '    Return ConstantClassLibrary.ASLXNA.PersUnitResult.Pins
        'End If
        End If
        End Function

        Public Function HOBMC() As Integer Implements TargetPersUniti.HOBMC

        End Function

        Public Property HoBFlag As Boolean Implements TargetPersUniti.HoBFlag
        Get
        Return myHOBFlag
        End Get
        Set(value As Boolean)
        myHOBFlag = value
        End Set
        End Property
        End Class
        Public Class FiringHeroicLdrc
        Implements FireUnitDecoratori
        'Holds units and sw - selected fields for combat only
        ' object held in FireGroup ArrayList
        Private myIsEncirc As Boolean = False
        Private myCX As Boolean = False
        Private myCombatStatus As Integer
        Private myIsPinned As Boolean
        Private myCombatFP As Double
        Private mySolID As Integer
        Private myHasMG As Boolean
        Private myUsingInherentFP As Boolean
        Private myUsingfirstMG As Boolean
        Private myUsingsecondMG As Boolean
        Private myIsInCrestStatus As Boolean
        Private myhexposition As Integer
        Private myOBLink As Integer
        Private MapCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private MyLoc As MapDataClassLibrary.GameLocation
        Private myBaseUnit As ObjectClassLibrary.ASLXNA.FiringPersUniti
        Private myUsingHeroorLeader As Integer
        'constructor - overloaded to handle different points of construction: new during play from leader unit; at startup from existing leaderhero
        Public Sub New(ByVal PassFiringUnit As ObjectClassLibrary.ASLXNA.FiringPersUniti)  'creating from a leader
        'called by
        myBaseUnit = PassFiringUnit
        End Sub
        Public Sub New(ByVal PassIsCX As Boolean, ByVal PassIsPinned As Boolean, ByVal PassHasMG As Boolean, ByVal PassUsingInherentFP As Boolean, ByVal PassUsingfirstMG As Boolean, ByVal PassUsingsecondMG As Boolean, ByVal PassUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        'called by ObjectFactory.Perscreation.createfiringunitproperty
        'created from existing instance of ldrhero
        If PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Encircled Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Enc_Wnd Or
        PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Enc Or PassUnit.BasePersUnit.FortitudeStatus = ConstantClassLibrary.ASLXNA.FortitudeStatus.Fan_Wnd_Enc Then
        Me.myIsEncirc = True
        End If
        Me.myCombatStatus = PassUnit.BasePersUnit.CombatStatus
        Me.myIsPinned = PassIsPinned
        Me.mySolID = PassUnit.BasePersUnit.SolID
        myCombatFP = 0
        Me.myCX = PassIsCX
        Me.myHasMG = PassHasMG
        Me.myUsingInherentFP = PassUsingInherentFP
        Me.myUsingfirstMG = PassUsingfirstMG
        Me.myUsingsecondMG = PassUsingsecondMG
        Dim NewDb As MapDataClassLibrary.MapDataClassesDataContext = New MapDataClassLibrary.MapDataClassesDataContext
        Try
        Dim LOCCol As IQueryable(Of MapDataClassLibrary.GameLocation) = From QU As MapDataClassLibrary.GameLocation In NewDb.GameLocations Select QU
        MapCol = LOCCol
        Catch ex As Exception
        ' MsgBox("Some kind of error" & ASLMapLink, , "CreateMapCollection Failure")
        End Try
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        MyLoc = Getlocs.RetrieveLocationfromHex(CInt(PassUnit.BasePersUnit.LOCIndex))
        myIsInCrestStatus = PassUnit.BasePersUnit.IsInCrestStatus
        myhexposition = PassUnit.BasePersUnit.hexPosition
        myOBLink = PassUnit.BasePersUnit.Unit_ID
        myBaseUnit = PassUnit.FiringPersUnit
        myUsingHeroorLeader = 0
        End Sub 'New

        Public Sub AdvancingFireModification(Phase As Integer) Implements FiringPersUniti.AdvancingFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Phase

        If myUsingInherentFP AndAlso Phase = ConstantClassLibrary.ASLXNA.Phase.AdvancingFire And _
        Me.myCombatStatus <> ConstantClassLibrary.ASLXNA.CombatStatus.OppFirer Then
        'area due to advancing fire
        'ARE THERE OTHER AREA CONDITIONS NOT REFLECTED IN THIS?
        myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AreaFireModification(FGSize As Integer, targloc As MapDataClassLibrary.GameLocation) Implements FiringPersUniti.AreaFireModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread and IFTC.CalcFPandDRM
        'reduces FP for each Area fire case

        'cellar
        If myUsingInherentFP AndAlso FGSize >= 3 Then
        Dim ReducedFP As Boolean = False
        If MyLoc.Location = ConstantClassLibrary.ASLXNA.Location.Cellar Then
        ReducedFP = True
        If targloc.IsCellar Then ReducedFP = False 'must be part of building or LOS would not exist and would not be here; no need to check again
        If targloc.Hexnum = MyLoc.Hexnum And targloc.LevelInHex > MyLoc.LevelInHex Then ReducedFP = False 'must be grounhd level or LOS would not exist and would not be here; no need to check again
        End If
        If ReducedFP Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub AssaultFireModification(Phase As Integer) Implements FiringPersUniti.AssaultFireModification

        End Sub

        Public ReadOnly Property AssF As Boolean Implements FiringPersUniti.AssF
        Get
        Return False
        End Get
        End Property

        Public ReadOnly Property BaseFP As Integer Implements FiringPersUniti.BaseFP
        Get
        If myUsingHeroorLeader = ConstantClassLibrary.ASLXNA.Utype.Hero Then Return 1 Else Return 0
        End Get
        End Property

        Public ReadOnly Property BaseRange As Integer Implements FiringPersUniti.BaseRange
        Get
        Return 4
        End Get
        End Property

        Public ReadOnly Property CombatFP As Double Implements FiringPersUniti.CombatFP
        Get
        Return myCombatFP
        End Get
        End Property

        Public Property CombatStatus As Integer Implements FiringPersUniti.CombatStatus
        Get
        Return myCombatStatus
        End Get
        Set(value As Integer)
        myCombatStatus = value
        End Set
        End Property
        Public Sub CrestStatusModification(Targethexnum As Integer) Implements FiringPersUniti.CrestStatusModification
        'called by EnemyValuesConcreteC.CalcFPandDRM_thread
        'amends inherent FP for unit in CrestStatus - handles blocked by wall and  firing outside crest CA
        If myUsingInherentFP Then
        If Not myIsInCrestStatus Then Exit Sub 'if not in creststatus should not be here
        Dim MapGeo as mapgeoclasslibrary.aslxna.mapgeoc = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) 'can use null values if sure instance already exists
        Dim hexsidescrossed As List(Of Integer) = MapGeo.LOSSideEntry(Targethexnum, CInt(MyLoc.Hexnum))  'use reversed order for hexes to get exit hexsides
        Dim IsCrossingWHR As Boolean = False
        For Each nexthexside As Integer In hexsidescrossed
        Select Case nexthexside
        Case 1
        IsCrossingWHR = MyLoc.Side1IsWHR
        Case 2
        IsCrossingWHR = MyLoc.Side2IsWHR
        Case 3
        IsCrossingWHR = MyLoc.Side3IsWHR
        Case 4
        IsCrossingWHR = MyLoc.Side4IsWHR
        Case 5
        IsCrossingWHR = MyLoc.Side5IsWHR
        Case 6
        IsCrossingWHR = MyLoc.Side6IsWHR
        Case Else
        MsgBox("Hexside failure")
        IsCrossingWHR = False
        End Select
        If IsCrossingWHR Then
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        myCombatFP = 0  'wall/hedge blocks LOS by entrenched unit
        Exit Sub
        End If
        End If
        Next

        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestCA As Integer = 0 : Dim UsingCrestCA As Boolean = False
        If myhexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And myhexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        CrestCA = CrestTest.CrestSideToSide(myhexposition)
        Else
        CrestCA = CrestTest.WACrestSideToSide(myhexposition)
        End If
        Dim MinusCrestCA As Integer = 0 : Dim PlusCrestCA As Integer = 0
        'DONT THINK THIS CODE IS RIGHT - USES WRONG CA DEFINITION - CHECK AUG 13
        For Each nexthexside As Integer In hexsidescrossed
        If CrestCA = 6 Then PlusCrestCA = 1 Else PlusCrestCA = CrestCA + 1
        If CrestCA = 1 Then MinusCrestCA = 6 Else MinusCrestCA = CrestCA - 1
        If CrestCA = nexthexside Or MinusCrestCA = nexthexside Or PlusCrestCA = nexthexside Then
        UsingCrestCA = True : Exit For
        End If
        Next
        If Not UsingCrestCA Then myCombatFP = myCombatFP / 2
        End If
        End Sub

        Public Sub FireVsConcealedModification(TargetUnit As PersUniti) Implements FiringPersUniti.FireVsConcealedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Concealed Target
        If myUsingInherentFP AndAlso TargetUnit.BasePersUnit.VisibilityStatus = ConstantClassLibrary.ASLXNA.VisibilityStatus.Concealed Then myCombatFP = myCombatFP / 2
        End Sub

        Public Property FiringMGs As List(Of SuppWeapi) Implements FiringPersUniti.FiringMGs

        Public Sub FirstFireModification() Implements FiringPersUniti.FirstFireModification
        'called by IFT.CalcFP
        'changes CombatFP property based on Def First Fire

        If myUsingInherentFP AndAlso Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then myCombatFP = myCombatFP / 2
        End Sub

        Public ReadOnly Property HasMG As Boolean Implements FiringPersUniti.HasMG
        Get
        Return myBaseUnit.HasMG
        End Get
        End Property

        Public ReadOnly Property HeroDRM As Integer Implements FiringPersUniti.HeroDRM
        Get
        Return -1
        End Get
        End Property

        Public ReadOnly Property IsCX As Boolean Implements FiringPersUniti.IsCX
        Get
        Return myBaseUnit.IsCX
        End Get
        End Property

        Public ReadOnly Property IsEncirc As Boolean Implements FiringPersUniti.IsEncirc
        Get
        Return myBaseUnit.IsEncirc
        End Get
        End Property

        Public Property IsPinned As Boolean Implements FiringPersUniti.IsPinned
        Get
        Return myBaseUnit.IsPinned
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public ReadOnly Property LdrDRM As Integer Implements FiringPersUniti.LdrDRM
        Get
        Return myBaseUnit.LdrDRM
        End Get
        End Property

        Public ReadOnly Property LOBLink As Integer Implements FiringPersUniti.LOBLink
        Get
        Return myBaseUnit.LOBLink + 120
        End Get
        End Property

        Public Sub MGModification() Implements FiringPersUniti.MGModification

        End Sub

        Public Sub PinnedModification() Implements FiringPersUniti.PinnedModification
        'called by IFT.CalcFP
        'changes CombatFP property based on pinned Status

        If myUsingInherentFP And IsPinned Then myCombatFP = myCombatFP / 2
        End Sub

        Public Sub RangeModification(range As Single, LevelDifference As Single, TargetU As PersUniti) Implements FiringPersUniti.RangeModification
        'called by IFT.CalcFP
        'changes CombatFP property based on BaseFP, BaseRange and Combat range
        If myUsingInherentFP Then
        Dim TempFP As Double = BaseFP
        Dim RangeFactor As Single = 1   'holds value of combat range/base range
        Dim comboFPitem As Integer = 0 'hold value of cbxFP index to be passed to Gameform routine
        RangeFactor = CSng(range / BaseRange)
        Select Case RangeFactor
        Case Is <= 1
        If (range = 1 And (LevelDifference >= -1)) Or (range = 0 And (LevelDifference = -1 Or LevelDifference > 0)) Then  'level difference is positive when firer above target
        'PBF
        TempFP = TempFP * 2
        ElseIf range = 0 And LevelDifference = 0 Then
        'do pillbox check - LOS needs be within CA
        Dim TerrGet = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(MapCol)
        Dim HexLocIndex As Integer = TerrGet.GetPillboxLocation(MyLoc.Hexnum)
        Dim UsingHex As MapDataClassLibrary.GameLocation
        If HexLocIndex > 0 Then
        Dim PillboxLOS As Boolean = False
        'get Pillbox location
        UsingHex = TerrGet.RetrieveLocationfromHex(HexLocIndex)
        'Now determine Pillbox covered arc
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.TerrainChecks(MapCol)
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim Imagename As String = TerrChk.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(UsingHex.Location), Maptables)
        Dim Linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()  'use null values when sure instance exists
        Dim TestCA As DataClassLibrary.LookupCA = (From Qu In Linqdata.db.LookupCAs Where Qu.Terraindesc = Imagename).First
        'compare entry hexside with Pillbox CA
        If TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.FirstCA Or TargetU.MovingPersUnit.HexEnteredSideCrossed = TestCA.SecondCA Then
        PillboxLOS = True
        End If
        If Not PillboxLOS Then TempFP = 0 Else TempFP = TempFP * 2
        Else
        'if here then no pillbox issues so continue
        'TPBF
        TempFP = TempFP * 3
        End If
        End If
        Case 1.0001 To 2
        If Me.myCombatStatus = ConstantClassLibrary.ASLXNA.CombatStatus.FirstFirer Then
        'MsgBox(String.Format("First Firer {0} is beyond maximum range", Trim(Name)), , "No FP Added")
        TempFP = 0
        Else
        'Long range
        TempFP = TempFP / 2
        End If
        Case Is > 2
        'MsgBox(Trim(Me.Name) & " is beyond maximum range", , "No FP Added")
        TempFP = 0
        End Select
        myCombatFP = TempFP
        End If
        End Sub

        Public Sub ResetCombatFP() Implements FiringPersUniti.ResetCombatFP
        myCombatFP = 0
        End Sub

        Public ReadOnly Property SolID As Integer Implements FiringPersUniti.SolID
        Get
        Return myBaseUnit.SolID
        End Get
        End Property

        Public Sub SprayFireModification(UsingSprayFire As Boolean) Implements FiringPersUniti.SprayFireModification

        End Sub

        Public ReadOnly Property Type As Integer Implements FiringPersUniti.Type
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.LdrHero
        End Get
        End Property

        Public Sub UpdateCombatStatus(NewCombatStatus As Integer, ROFdr As Integer) Implements FiringPersUniti.UpdateCombatStatus
        myCombatStatus = NewCombatStatus
        Dim FiringMG As ObjectClassLibrary.ASLXNA.SuppWeapi
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(myOBLink)
        UpdateUnit.CombatStatus = Me.CombatStatus
        'BaseUnit.BasePersUnit.CombatStatus = Me.CombatStatus
        'If Me.UsingfirstMG Then
        '    FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.FirstSWLink).First
        '    FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        'End If
        'If Me.UsingsecondMG Then
        '    FiringMG = (From getMG As ObjectClassLibrary.ASLXNA.SuppWeapi In Me.FiringMGs Where getMG.BaseSW.Unit_ID = myBaseUnit.BasePersUnit.SecondSWlink).First
        '    FiringMG.FiringSW.UpdateCombatStatus(NewCombatStatus, ROFdr)
        'End If
        Linqdata.QuickUpdate()
        End Sub

        Public Property UseHeroOrLeader As Integer Implements FiringPersUniti.UseHeroOrLeader
        Get
        Return myUsingHeroorLeader
        End Get
        Set(ByVal Usevalue As Integer)
        myUsingHeroorLeader = Usevalue
        End Set
        End Property

        Public Property UsingfirstMG As Boolean Implements FiringPersUniti.UsingfirstMG
        Get
        Return myUsingfirstMG
        End Get
        Set(value As Boolean)
        myUsingfirstMG = value
        End Set
        End Property
        Public Property UsingInHerentFP As Boolean Implements FiringPersUniti.UsingInHerentFP
        Get
        Return myUsingInherentFP
        End Get
        Set(value As Boolean)
        myUsingInherentFP = value
        End Set
        End Property
        Public Property UsingsecondMG As Boolean Implements FiringPersUniti.UsingsecondMG
        Get
        Return myUsingsecondMG
        End Get
        Set(value As Boolean)
        myUsingsecondMG = value
        End Set
        End Property
        End Class
        Public Class BaseHeroicLdrc
        Implements ObjectClassLibrary.ASLXNA.BaseUnitDecoratori
        'Private myHexname As String
        'Private myScenario As Integer
        'Private myHexnum As Integer
        'Private myhexlocation As Integer
        'Private myhexPosition As Integer
        'Private myLevelinHex As Single
        'Private myLOCIndex As Integer
        'Private myCX As Boolean
        'Private myELR As Integer
        'Private myTurnArrives As Integer
        'Private myNationality As Integer
        'Private myCon_ID As Integer      'OB id of associated concealment counter; for concealment counters themsleves is always 0  Orderofbattle.con_id
        'Private myUnit_ID As Integer     'OB id of the personnel/SW/concealment counter  Orderofbattle.OBUnit_ID/Concealment.con_id/OrderofBattleSW/OBSW_ID
        'Private myTypeType_ID As Integer      ' value of Enum.TypeType for all counters
        'Private myUnitType As Integer 'value of Unittype; stored in LOB and SMC tables;  equals Enum.Utype
        'Private myFirstSWLink As Integer
        'Private mySecondSWlink As Integer
        'Private mySW As Integer
        'Private myHexEntSideCrossed As Integer
        'Private mySolID As Integer
        'Private myUnitName As String
        'Private myLOBLink As Integer     'ID of LineOfBattle or SupportWeapon of which this object is an instance  OrderofBattle.LOBLink/OrderofBattleSW.Weapontype  for concealment is always 0
        'Private myMovementStatus As Integer
        'Private myFortitudeStatus As Integer
        'Private myOrderStatus As Integer
        'Private myVisibilityStatus As Integer
        'Private myCombatStatus As Integer
        'Private myCharacterStatus As Integer
        'Private myRoleStatus As Integer
        'Private myPinned As Boolean
        'Private myUnitClass As Integer   'value of Enum.UClass for personnel units; always 0 for concealment and SW counters   LineOfBattle.Class
        Private pOBTexture As Microsoft.Xna.Framework.Graphics.Texture2D  'holds value of image
        Private BaseUnit As ObjectClassLibrary.ASLXNA.Basepersuniti
        'Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private myGuarding As New List(Of ObjectClassLibrary.ASLXNA.PersUniti)
        Public Sub New(ByVal PassBaseUnit As ObjectClassLibrary.ASLXNA.Basepersuniti)
        'BaseParent = PassParentUnit
        BaseUnit = PassBaseUnit
        End Sub
        Public Property CharacterStatus As Integer Implements Basepersuniti.CharacterStatus
        Get
        Return BaseUnit.CharacterStatus
        End Get
        Set(value As Integer)
        BaseUnit.CharacterStatus = value
        End Set
        End Property

        Public Property CombatStatus As Integer Implements Basepersuniti.CombatStatus
        Get
        Return BaseUnit.CombatStatus
        End Get
        Set(value As Integer)
        BaseUnit.CombatStatus = value
        End Set
        End Property
        Public Property Con_ID As Integer Implements Basepersuniti.Con_ID
        Get
        Return BaseUnit.Con_ID
        End Get
        Set(value As Integer)
        BaseUnit.Con_ID = value
        End Set
        End Property
        Public Property CX As Boolean Implements Basepersuniti.CX
        Get
        Return BaseUnit.CX
        End Get
        Set(value As Boolean)
        BaseUnit.CX = value
        End Set
        End Property
        Public ReadOnly Property DrawPos(MapBtype As Integer, MapXOffset As Single, MapYOffset As Single, MapMaxcols As Integer, MapMaxrows As Integer) As Microsoft.Xna.Framework.Vector2 Implements Basepersuniti.DrawPos
        Get
        Return BaseUnit.DrawPos(MapBtype, MapXOffset, MapYOffset, MapMaxcols, MapMaxrows)
        End Get
        End Property

        Public Property ELR As Integer Implements Basepersuniti.ELR
        Get
        Return BaseUnit.ELR
        End Get
        Set(value As Integer)
        BaseUnit.ELR = value
        End Set
        End Property
        Public Property FirstSWLink As Integer Implements Basepersuniti.FirstSWLink
        Get
        Return BaseUnit.FirstSWLink
        End Get
        Set(value As Integer)
        BaseUnit.FirstSWLink = value
        End Set
        End Property
        Public Property FortitudeStatus As Integer Implements Basepersuniti.FortitudeStatus
        Get
        Return BaseUnit.FortitudeStatus
        End Get
        Set(value As Integer)
        BaseUnit.FortitudeStatus = value
        End Set
        End Property
        Public Function GetSW(SW1or2 As Integer) As Integer Implements Basepersuniti.GetSW
        BaseUnit.GetSW(SW1or2)
        End Function

        Public Function HasWallAdvantage() As Boolean Implements Basepersuniti.HasWallAdvantage
        BaseUnit.HasWallAdvantage()
        End Function

        Public Property HexEntSideCrossed As Integer Implements Basepersuniti.HexEntSideCrossed
        Get
        Return BaseUnit.HexEntSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEntSideCrossed = value
        End Set
        End Property
        Public Property hexlocation As Integer Implements Basepersuniti.hexlocation
        Get
        Return BaseUnit.hexlocation
        End Get
        Set(value As Integer)
        BaseUnit.hexlocation = value
        End Set
        End Property
        Public Property Hexname As String Implements Basepersuniti.Hexname
        Get
        Return BaseUnit.Hexname
        End Get
        Set(value As String)
        BaseUnit.Hexname = value
        End Set
        End Property
        Public Property Hexnum As Integer Implements Basepersuniti.Hexnum
        Get
        Return BaseUnit.Hexnum
        End Get
        Set(value As Integer)
        BaseUnit.Hexnum = value
        End Set
        End Property
        Public Property hexPosition As Integer Implements Basepersuniti.hexPosition
        Get
        Return BaseUnit.hexPosition
        End Get
        Set(value As Integer)
        BaseUnit.hexPosition = value
        End Set
        End Property
        Public Function IsInCrestStatus() As Boolean Implements Basepersuniti.IsInCrestStatus
        BaseUnit.IsInCrestStatus()
        End Function

        Public Function IsUnitALeader() As Boolean Implements Basepersuniti.IsUnitALeader
        Return True
        End Function

        Public Function IsUnitASMC() As Boolean Implements Basepersuniti.IsUnitASMC
        Return True
        End Function

        Public Function IsUnitEncircled() As Boolean Implements Basepersuniti.IsUnitEncircled
        BaseUnit.IsUnitEncircled()
        End Function

        Public Function IsUnitGreen() As Boolean Implements Basepersuniti.IsUnitGreen
        BaseUnit.IsUnitGreen()
        End Function

        Public Function IsUnitInexperienced() As Boolean Implements Basepersuniti.IsUnitInexperienced
        BaseUnit.IsUnitInexperienced()
        End Function

        Public ReadOnly Property LeftPos(MapBtype As Integer, MapXOffset As Single, MapYOffset As Single, MapMaxcols As Integer, MapMaxrows As Integer) As Integer Implements Basepersuniti.LeftPos
        Get
        Return BaseUnit.LeftPos(MapBtype, MapXOffset, MapYOffset, MapMaxcols, MapMaxrows)
        End Get
        End Property

        Public Property LevelinHex As Single Implements Basepersuniti.LevelinHex
        Get
        Return BaseUnit.LevelinHex
        End Get
        Set(value As Single)
        BaseUnit.LevelinHex = value
        End Set
        End Property
        Public ReadOnly Property LOBLink As Integer Implements Basepersuniti.LOBLink
        Get
        Return BaseUnit.LOBLink + 120
        End Get
        End Property

        Public Property LOCIndex As Integer Implements Basepersuniti.LOCIndex
        Get
        Return BaseUnit.LOCIndex
        End Get
        Set(value As Integer)
        BaseUnit.LOCIndex = value
        End Set
        End Property
        Public Property MovementStatus As Integer Implements Basepersuniti.MovementStatus
        Get
        Return BaseUnit.MovementStatus
        End Get
        Set(value As Integer)
        BaseUnit.MovementStatus = value
        End Set
        End Property
        Public ReadOnly Property Nationality As Integer Implements Basepersuniti.Nationality
        Get
        Return BaseUnit.Nationality
        End Get
        End Property

        Public Property OBTexture As Microsoft.Xna.Framework.Graphics.Texture2D Implements Basepersuniti.OBTexture
        Get
        Return pOBTexture
        End Get
        Set(ByVal value As Microsoft.Xna.Framework.Graphics.Texture2D)
        pOBTexture = value
        End Set
        End Property
        Public Property OrderStatus As Integer Implements Basepersuniti.OrderStatus
        Get
        Return BaseUnit.OrderStatus
        End Get
        Set(value As Integer)
        BaseUnit.OrderStatus = value
        End Set
        End Property
        Public Property Pinned As Boolean Implements Basepersuniti.Pinned
        Get
        Return BaseUnit.Pinned
        End Get
        Set(value As Boolean)
        BaseUnit.Pinned = value
        End Set
        End Property
        Public Property RoleStatus As Integer Implements Basepersuniti.RoleStatus
        Get
        Return BaseUnit.RoleStatus
        End Get
        Set(value As Integer)
        BaseUnit.RoleStatus = value
        End Set
        End Property
        Public ReadOnly Property Scenario As Integer Implements Basepersuniti.Scenario
        Get
        Return BaseUnit.Scenario
        End Get
        End Property

        Public Property SecondSWlink As Integer Implements Basepersuniti.SecondSWlink
        Get
        Return BaseUnit.SecondSWlink
        End Get
        Set(value As Integer)
        BaseUnit.SecondSWlink = value
        End Set
        End Property
        Public Function SetID(NewID As Integer) As Boolean Implements Basepersuniti.SetID
        BaseUnit.SetID(NewID)
        End Function

        Public Property SolID As Integer Implements Basepersuniti.SolID
        Get
        Return BaseUnit.SolID
        End Get
        Set(value As Integer)
        BaseUnit.SolID = value
        End Set
        End Property
        Public Property SW As Integer Implements Basepersuniti.SW
        Get
        Return BaseUnit.SW
        End Get
        Set(value As Integer)
        BaseUnit.SW = value
        End Set
        End Property
        Public ReadOnly Property TopPos(MapBtype As Integer, MapXOffset As Single, MapYOffset As Single, MapMaxcols As Integer, MapMaxrows As Integer) As Integer Implements Basepersuniti.TopPos
        Get
        Return BaseUnit.TopPos(MapBtype, MapXOffset, MapYOffset, MapMaxcols, MapMaxrows)
        End Get
        End Property

        Public ReadOnly Property TurnArrives As Integer Implements Basepersuniti.TurnArrives
        Get
        Return BaseUnit.TurnArrives
        End Get
        End Property

        Public Property TypeType_ID As Integer Implements Basepersuniti.TypeType_ID
        Get
        Return BaseUnit.TypeType_ID
        End Get
        Set(value As Integer)
        BaseUnit.TypeType_ID = value
        End Set
        End Property
        Public ReadOnly Property Unit_ID As Integer Implements Basepersuniti.Unit_ID
        Get
        Return BaseUnit.Unit_ID
        End Get
        End Property

        Public Property UnitClass As Integer Implements Basepersuniti.UnitClass
        Get
        Return ConstantClassLibrary.ASLXNA.UClass.Elite
        End Get
        Set(value As Integer)

        End Set
        End Property
        Public ReadOnly Property UnitName As String Implements Basepersuniti.UnitName
        Get
        Return BaseUnit.UnitName
        End Get
        End Property

        Public ReadOnly Property Unittype As Integer Implements Basepersuniti.Unittype
        Get
        Return ConstantClassLibrary.ASLXNA.Utype.LdrHero
        End Get
        End Property

        Public Function UpdateBaseStatus(PassUnit As PersUniti) As Boolean Implements Basepersuniti.UpdateBaseStatus
        Dim Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Dim UpdateUnit As DataClassLibrary.OrderofBattle = Linqdata.GetUnitfromCol(PassUnit.BasePersUnit.Unit_ID)

        UpdateUnit.CX = CX
        UpdateUnit.ELR = CType(ELR, Short?)
        UpdateUnit.Pinned = Pinned
        UpdateUnit.CombatStatus = CombatStatus
        UpdateUnit.MovementStatus = MovementStatus
        UpdateUnit.FirstSWLink = CType(FirstSWLink, Short?)
        UpdateUnit.SecondSWlink = CType(SecondSWlink, Short?)
        UpdateUnit.SW = CType(SW, Short?)
        UpdateUnit.TurnArrives = CType(TurnArrives, Short?)
        UpdateUnit.hexnum = CType(Hexnum, Short?)
        UpdateUnit.Hexname = Hexname
        UpdateUnit.hexlocation = hexlocation
        UpdateUnit.Position = hexPosition
        UpdateUnit.LocIndex = LOCIndex
        UpdateUnit.LevelinHex = LevelinHex
        UpdateUnit.HexEnteredSideCrossedLastMove = HexEntSideCrossed
        UpdateUnit.FortitudeStatus = FortitudeStatus
        UpdateUnit.RoleStatus = RoleStatus
        UpdateUnit.VisibilityStatus = VisibilityStatus
        Linqdata.QuickUpdate()
        End Function

        Public Property VisibilityStatus As Integer Implements Basepersuniti.VisibilityStatus
        Get
        Return BaseUnit.VisibilityStatus
        End Get
        Set(value As Integer)
        BaseUnit.VisibilityStatus = value
        End Set
        End Property
        Public Function CanGuard(ByVal Prisonertype As Integer) As Boolean Implements Basepersuniti.CanGuard

        Dim TotalPrisonerSize As Integer = 0 : Dim NewPrisonerSize As Integer = 0
        Dim TotalPrisonerCapacity As Integer = 5
        If Prisonertype = ConstantClassLibrary.ASLXNA.Utype.Squad Then
        NewPrisonerSize += 3
        ElseIf Prisonertype = ConstantClassLibrary.ASLXNA.Utype.HalfSquad Or Prisonertype = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        NewPrisonerSize += 2
        Else
        NewPrisonerSize += 1
        End If
        If myGuarding.Count = 0 Then Return True
        For Each Prisoner As ObjectClassLibrary.ASLXNA.PersUniti In myGuarding
        If Prisoner.BasePersUnit.Unittype = ConstantClassLibrary.ASLXNA.Utype.Squad Then
        TotalPrisonerSize += 3
        ElseIf Prisoner.BasePersUnit.Unittype = ConstantClassLibrary.ASLXNA.Utype.HalfSquad Or Prisoner.BasePersUnit.Unittype = ConstantClassLibrary.ASLXNA.Utype.Crew Then
        TotalPrisonerSize += 2
        Else
        TotalPrisonerSize += 1
        End If
        If TotalPrisonerSize + NewPrisonerSize <= TotalPrisonerCapacity Then Return True Else Return False
        Next
        End Function

        Public ReadOnly Property Guarding As List(Of PersUniti) Implements Basepersuniti.Guarding
        Get
        Return myGuarding
        End Get
        End Property

        Public Function AddPrisoner(PassUnit As PersUniti) As Boolean Implements Basepersuniti.AddPrisoner
        myGuarding.Add(PassUnit)
        End Function

        Public Function DeletePrisoner(PassUnit As PersUniti) As Boolean Implements Basepersuniti.DeletePrisoner
        myGuarding.Remove(PassUnit)
        End Function
        End Class

        Public Class MovingHeroicLdrc
        Implements MoveUnitDecoratori

        Private BaseUnit As ObjectClassLibrary.ASLXNA.MovingPersuniti
        Private BaseParent As ObjectClassLibrary.ASLXNA.PersUniti
        Private MFleft As Single
        Private UsingDTvalue As Boolean
        Private UsingRBvalue As Boolean
        Private hasldrbvalue As Boolean
        Private mfusedvalue As Single
        Private DTBonus As Integer = 0

        Public Sub New(ByVal PassParentUnit As ObjectClassLibrary.ASLXNA.PersUniti)
        BaseParent = PassParentUnit
        BaseUnit = BaseParent.MovingPersUnit
        UsingDTvalue = True : UsingRBvalue = BaseUnit.UsingRoadBonus
        mfusedvalue = BaseUnit.MFUsed
        If mfusedvalue > 0 Then DTBonus = 1 Else DTBonus = 2
        End Sub
        Public Function CalcMF() As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.CalcMF
        Return 6
        End Function

        Public Property MFAvailable As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFAvailable
        Get
        Return MFleft
        End Get
        Set(value As Single)
        MFleft = value
        End Set
        End Property

        Public ReadOnly Property OBName As String Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemName
        Get
        Return BaseUnit.ItemName
        End Get
        End Property

        Public ReadOnly Property itemID As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.ItemID
        Get
        Return BaseUnit.ItemID
        End Get
        End Property

        Public ReadOnly Property IPC As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IPC
        Get
        Return BaseUnit.IPC
        End Get
        End Property

        Public ReadOnly Property IsDummy As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsDummy
        Get
        Return False
        End Get
        End Property

        Public Property IsConcealed As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.IsConcealed
        Get
        Return BaseUnit.IsConcealed
        End Get
        Set(value As Boolean)
        BaseUnit.IsConcealed = value
        End Set
        End Property
        Public Property UsingDT As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingDT
        Get
        Return BaseUnit.UsingDT
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property UsingRoadBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.UsingRoadBonus
        Get
        Return BaseUnit.UsingRoadBonus
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property HasLdrBonus As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HasLdrBonus
        Get
        Return False
        End Get
        Set(value As Boolean)

        End Set
        End Property

        Public Property MFUsed As Single Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.MFUsed
        Get
        Return mfusedvalue
        End Get
        Set(value As Single)
        mfusedvalue = value
        If value > 0 Then
        'Dim UpdateTarget As New SetTargetMoveStatus
        'UpdateTarget.setMoveStatus()
        End If
        End Set
        End Property
        Public ReadOnly Property PPImpact As Boolean Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.PPImpact
        Get
        Return False
        End Get
        End Property

        Public Property AssaultMove As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.AssaultMove
        Get
        Return BaseUnit.AssaultMove
        End Get
        Set(value As Integer)
        BaseUnit.AssaultMove = value
        End Set
        End Property

        Public Property Dash As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.Dash
        Get
        Return BaseUnit.Dash
        End Get
        Set(value As Integer)
        BaseUnit.Dash = value
        End Set
        End Property

        Public Property HexEnteredSideCrossed As Integer Implements ObjectClassLibrary.ASLXNA.MovingPersuniti.HexEnteredSideCrossed
        Get
        Return BaseUnit.HexEnteredSideCrossed
        End Get
        Set(value As Integer)
        BaseUnit.HexEnteredSideCrossed = value
        End Set
        End Property

        Public ReadOnly Property SmokeE As Integer Implements MovingPersuniti.SmokeE
        Get
        Return BaseUnit.SmokeE
        End Get
        End Property
        End Class
        #End Region


public class SmokeHolder {
        /*Private smokevalue As Integer
        Private smokebase As Integer
        Public Sub New(ByVal PassSmoke As Integer, ByVal PassBaselevel As Integer)
        smokevalue = PassSmoke
        smokebase = PassBaselevel
        End Sub
        'properties
        Public ReadOnly Property Smoke As Integer
        Get
        Return smokevalue
        End Get
        End Property
        Public ReadOnly Property SmokeBaseLevel As Integer
        Get
        Return smokebase
        End Get
        End Property
}


        Public Class LocationContent
        'this class holds instances of objects that are in a given location in a hex
        'this includes OB units (visible, concealed and hidden), vehicles (V, C, and H), Guns (V, C, H), OBSW (V, C, H), Terrain (Visible or Hidden), and Concealment (dummies only)
        Private ReadOnly ObjIDvalue As Integer   ' the unique instance id from the database table
        Private locindexvalue As Integer  ' which location in the hex; using the Map table LocIndex values
        Private TypeIDvalue As Integer  ' what type of object (which LOB type of unit, of gun, or vehicle or sw)
        Private selectedvalue As Boolean 'may be useful to allow identification of which items being acted upon.
        'constructor
        Sub New(ByVal ObjectID As Integer, ByVal hexlocation As Integer, ByVal ObjectTypeID As Integer)
        'called by Action classes New after creating collections
        'may need overloads
        ObjIDvalue = ObjectID
        locindexvalue = hexlocation
        TypeIDvalue = ObjectTypeID
        selectedvalue = False 'default value
        End Sub
        'Properties
        Public ReadOnly Property ObjID As Integer
        Get
        Return ObjIDvalue
        End Get
        End Property
        Public Property LocIndex As Integer
        Get
        Return locindexvalue
        End Get
        Set(value As Integer)
        locindexvalue = value
        End Set
        End Property
        Public Property TypeID As Integer
        Get
        Return TypeIDvalue
        End Get
        Set(value As Integer)
        TypeIDvalue = value
        End Set
        End Property
        Public Property Selected As Boolean
        Get
        Return selectedvalue
        End Get
        Set(value As Boolean)
        selectedvalue = value
        End Set
        End Property
        'Methods
        End Class


        'classes moved from MapShade.vb Sept 2014

        Public Class LOSLevel
        Private pLOSLevel As Single
        Private pLOSResult As Integer
        Public Sub New()

        End Sub
        Public Property Level As Single
        Get
        Return pLOSLevel
        End Get
        Set(value As Single)
        pLOSLevel = value
        End Set
        End Property
        Public Property LOSResult As Integer
        Get
        Return pLOSResult
        End Get
        Set(value As Integer)
        pLOSResult = value
        End Set
        End Property
        End Class


        'collections class
        Public Class DrawCollectionsc
        Private Shared Colinstance As DrawCollectionsc
        Public HexeswithCounter As New Hashtable
        'constructor
        Private Sub New()            'called by Getinstance as part of singleton pattern
        HexToDraw = New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        'HexesWithCounter = New Hashtable
        End Sub



        'method used by constructor
        Public Shared Function GetInstance() As DrawCollectionsc
        'called by
        'instantiates object as singleton class - using singleton design pattern

        If IsNothing(Colinstance) Then
        Colinstance = New DrawCollectionsc()
        End If
        Return Colinstance
        End Function
        'properties
        Public Property HexToDraw As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        End Class
        'EVERYTHING BELOW THIS POINT NEEDS TO BE MOVED - BUT MUST BE REWORKED FIRST - INTO A CLASS LIBRARY ABOVE OBJECTS BUT BELOW ALL THE OTHER CLASS LIBRARIES IN THIS LAYER
        Public Class VisibleOccupiedhex
        'This is an object class that stores information about hexes which contain visible game elements (units, special terrain, fortifications, vehicles, etc) displayed as sprites
        'It includes methods for accessing the sprite information and for setting the display order of the sprites
        Private ReadOnly pHexnum As Integer
        Private ThingsIn As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Private Scencolls As ObjectClassLibrary.ASLXNA.ScenarioCollectionsc = ObjectClassLibrary.ASLXNA.ScenarioCollectionsc.GetInstance
        Private Drawcols As ObjectClassLibrary.ASLXNA.DrawCollectionsc = ObjectClassLibrary.ASLXNA.DrawCollectionsc.GetInstance
        Private Linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance
        Private LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private GameContent As New Microsoft.Xna.Framework.Game
        Public Sub New(ByVal hexnum As Integer, ByVal passGameContent As Microsoft.Xna.Framework.Game)
        pHexnum = hexnum
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        LocationCol = Maptables.LocationCol
        GameContent = passGameContent
        End Sub
        'properties
        Public ReadOnly Property Hexnum As Integer
        Get
        Return pHexnum
        End Get
        End Property
        Public Property VisibleCountersInHex As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        'this property stores all of the sprites in the hex as a list
        Get
        Return ThingsIn
        End Get
        Set(value As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder))
        ThingsIn = value
        End Set
        End Property
        'Methods
        Public Sub AddObjecttoDisplay(ByVal passsprite As ObjectClassLibrary.ASLXNA.SpriteOrder)
        ThingsIn.Add(passsprite)
        End Sub
        Public Function RedoDisplayOrder() As Boolean
        'called by Scenario.OpenScenario and after change to VisibleContentsInHex (add or remove) during play
        'orders display for hex where sprites to show (Not hidden items; visible counters - even if concealment, fortification - any sprite)

        'if no counters, then exit
        If VisibleCountersInHex.Count = 0 Then Return False
        'show top to bottom for levels
        'First sort counters by location
        Dim SpritesbyLocation = New SortSprites(VisibleCountersInHex, Hexnum)
        'then order all visible counters in hex - changes order held in VisibleCountersInHex NOT value of DisplayOrder
        VisibleCountersInHex = (From Displayitem In VisibleCountersInHex).OrderByDescending(Function(spriteorder) spriteorder.DisplayOrder).ToList
        ''renumber displayorder to match hex count  - NOT REQUIRED AUG 14
        'Dim Countstep As Integer = 0
        'For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In VisibleCountersInHex
        '    'DisplayCounter.DisplayOrder = VisibleCountersInHex.Count - Countstep
        '    Countstep += 1
        'Next
        'Set ontop counter to false and remove from Game.HexToDraw list
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In VisibleCountersInHex
        If DisplayCounter.Ontop Then
        DisplayCounter.Ontop = False
        Drawcols.HexToDraw.Remove(DisplayCounter)
        End If
        Next
        'Set Ontop counter
        VisibleCountersInHex.Item(0).Ontop = True  'this is why reorder so first item in VisibleCountersInHex is ALWAYS the Ontop unit
        'Store ontop-sprite texture and info in list to enable fast execution of Game.Draw routine
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = VisibleCountersInHex.Item(0)
        If Not (Drawcols.HexToDraw.Contains(Displaysprite)) Then Drawcols.HexToDraw.Add(Displaysprite) 'use contains test to avoid adding duplicates
        Return True
        End Function
        Public Sub CheckforAssociatedLocationCounter(ByVal passprite As ObjectClassLibrary.ASLXNA.SpriteOrder)
        'called by constructors for each counter type - so called before RedoDisplayOrder
        'when called by changes to counter location will need to be followed by a RedoDisplayOrder call
        'shows sewer, crest and other counters associated with inherent terrain if something in location

        Dim MapGeo As MapGeoClassLibrary.ASLXNA.MapGeoC = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        'check if location is basehex location
        Dim Getlocs = New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(LocationCol)
        Dim LevelChk = New TerrainClassLibrary.ASLXNA.LevelChecks(LocationCol)
        Dim UsingHex As MapDataClassLibrary.GameLocation = LevelChk.GetLocationatLevelInHex(Hexnum, 0)
        Dim Basehexloc As Integer = UsingHex.Location
        Dim IsTerrChk = New TerrainClassLibrary.ASLXNA.IsTerrain(LocationCol)
        Dim UsingLocation As Boolean = False : Dim UsingPosition As Boolean = False
        If (passprite.hexloc = Basehexloc Or passprite.hexloc = UsingHex.OtherTerraininLocation) And passprite.hexposition = 0 Then
        'check for fortified building and ground level - no counter required
        If Not IsTerrChk.IsLocationTerrainA(UsingHex.LocIndex, ConstantClassLibrary.ASLXNA.Location.FortBuildtype) Then Exit Sub
        End If
        If (passprite.hexloc = Basehexloc Or passprite.hexloc = UsingHex.OtherTerraininLocation) And passprite.hexposition > 0 Then
        'check if position in location requires counter (crest)
        If DoesPositionNeedCounter(passprite.hexposition) Then UsingPosition = True
        Else
        UsingLocation = True
        End If
        If Not (UsingPosition) And Not (UsingLocation) Then Exit Sub
        If UsingLocation Then
        'TEST - eliminate need for pillbox counter
        If passprite.hexloc >= ConstantClassLibrary.ASLXNA.Location.Pill1571 And passprite.hexloc <= ConstantClassLibrary.ASLXNA.Location.Bombprf Then Exit Sub
        'check if already visible
        Try
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In VisibleCountersInHex Where DoMatch.TypeID = passprite.hexloc
        Select DoMatch).First
        Exit Sub
        Catch ex As Exception
        End Try
        ElseIf UsingPosition Then
        'check if position is altpos, not requiring counter: such as pass/rider
        If passprite.hexposition = ConstantClassLibrary.ASLXNA.AltPos.Passenger Or passprite.hexposition = ConstantClassLibrary.ASLXNA.AltPos.Rider Or
        passprite.hexposition = ConstantClassLibrary.ASLXNA.AltPos.AboveWire Then Exit Sub 'Or passprite.hexloc = constantclasslibrary.aslxna.AltPos.UnderWire Then Exit Sub
        'check if already visible
        Try
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In VisibleCountersInHex Where DoMatch.TypeID = passprite.hexposition
        Select DoMatch).First
        Exit Sub
        Catch ex As Exception
        End Try
        If passprite.hexposition >= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 And passprite.hexposition <= ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Then
        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestPosTest As Integer = CrestTest.CresttoWACrest(passprite.hexposition)
        Try
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In VisibleCountersInHex Where DoMatch.TypeID = CrestPosTest
        Select DoMatch).First
        Exit Sub
        Catch ex As Exception
        End Try
        End If
        If passprite.hexposition >= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 And passprite.hexposition <= ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5 Then
        Dim CrestTest = New UtilClassLibrary.ASLXNA.ConversionC
        Dim CrestPosTest As Integer = CrestTest.WACresttoJustCrest(passprite.hexposition)
        Try
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In VisibleCountersInHex Where DoMatch.TypeID = CrestPosTest
        Select DoMatch).First
        Exit Sub
        Catch ex As Exception
        End Try
        End If
        End If

        'if not already visible then add
        'first handle fortified building
        If IsTerrChk.IsLocationTerrainA(passprite.LocIndex, ConstantClassLibrary.ASLXNA.Location.FortBuildtype) Then
        'show fortified counter
        Dim Passhexloc As MapDataClassLibrary.GameLocation = Getlocs.RetrieveLocationfromHex(Hexnum, passprite.hexloc)
        Dim ShowFort = New ShowLocationCounter(Passhexloc, GameContent)
        ShowFort.ShowFortified()
        Exit Sub
        End If

        Dim CounterToAdd = New DataClassLibrary.ScenarioTerrain
        Dim MousePos As PointF = New PointF() With {.X = passprite.Position.X + 23, .Y = passprite.Position.Y + 23}
        CounterToAdd.Hexnumber = passprite.hexnumber  'Mapgeo.MapCoord.GethexnumfromCoord(MousePos)
        CounterToAdd.Hexname = Getlocs.GetnamefromdatatableMap(Hexnum)
        'CounterToAdd.Hexname = Mapgeo.MapCoord.GethexnameFromCoord(MousePos)
        CounterToAdd.hexlocation = passprite.hexloc
        CounterToAdd.hexposition = passprite.hexposition
        CounterToAdd.LocIndex = passprite.LocIndex
        If UsingLocation Then
        CounterToAdd.FeatureType = CType(CounterToAdd.hexlocation, Short)
        ElseIf UsingPosition Then
        CounterToAdd.FeatureType = CType(CounterToAdd.hexposition, Short)
        End If
        'CounterToAdd.SetTexture()
        CounterToAdd.FeatTexture = GameContent.Content.Load(Of Texture2D)(Trim(CounterToAdd.SetTexture()))
        If Not (IsNothing(CounterToAdd.FeatTexture)) Then
        Dim SpritetoAdd = New ObjectClassLibrary.ASLXNA.SpriteOrder(0, CInt(CounterToAdd.hexlocation), CInt(CounterToAdd.FeatureType), CounterToAdd.FeatTexture, CounterToAdd.DrawPos(MapGeo.MapBtype, MapGeo.Xoffset, MapGeo.Yoffset, MapGeo.MaxCols, MapGeo.MaxRows), "", CInt(CounterToAdd.hexposition), CInt(CounterToAdd.Hexnumber), CInt(CounterToAdd.LocIndex))
        AddObjecttoDisplay(SpritetoAdd)
        End If
        End Sub
        Private Function DoesPositionNeedCounter(ByVal hexposition As Integer) As Boolean
        If hexposition > 6900 And hexposition < 6980 Then 'is position
        If hexposition < ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 Or (hexposition > ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 And
        hexposition < ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0) Or hexposition > ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5 Then Return False Else Return True
        Else
        Return False
        End If
        End Function
        Public Sub GetAllSpritesInHex(ByVal scenid As Integer)
        'called by various methods after making changes to a hex
        'part of redrawing the board and of redo of sprite display in designated hex; must check all counter types, set textures, etc; does not re-order for display
        Dim MapGeo As MapGeoClassLibrary.ASLXNA.MapGeoC = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        'clear sprites currently created and showing
        If Me.VisibleCountersInHex.Count > 0 Then
        Try
        Dim Topsprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From Qu As ObjectClassLibrary.ASLXNA.SpriteOrder In Me.VisibleCountersInHex Where Qu.Ontop = True).First
        Drawcols.HexToDraw.Remove(Topsprite) 'remove ontop sprite from draw list
        Catch
        End Try
        End If
        Me.VisibleCountersInHex.Clear()  'clear existing counters
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder
        Dim Unitsinhex = New List(Of ObjectClassLibrary.ASLXNA.PersUniti)
        Dim SWinhex = New List(Of ObjectClassLibrary.ASLXNA.SuppWeapi)
        Dim Coninhex = New List(Of ObjectClassLibrary.ASLXNA.PersUniti)
        Dim Vehinhex = New List(Of DataClassLibrary.AFV)
        Dim Guninhex = New List(Of DataClassLibrary.Gun)
        'add personnel
        Unitsinhex = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Hexnum = pHexnum Select GetUnit).ToList
        'Loop through counters
        'first unit (includes concealment)
        For Each unititem As ObjectClassLibrary.ASLXNA.PersUniti In Unitsinhex
        'determines if a counter should be visible and if so sets the texture
        Dim TextureName As String = unititem.SetTexture()
        If Not IsNothing(TextureName) Then
        unititem.BasePersUnit.OBTexture = GameContent.Content.Load(Of Texture2D)(Trim(TextureName))
        Displaysprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(unititem.BasePersUnit.Unit_ID, CInt(unititem.BasePersUnit.hexlocation), CInt(unititem.BasePersUnit.LOBLink), unititem.BasePersUnit.OBTexture, unititem.BasePersUnit.DrawPos(MapGeo.MapBtype, MapGeo.Xoffset, MapGeo.Yoffset, MapGeo.MaxCols, MapGeo.MaxRows), unititem.BasePersUnit.UnitName, CInt(unititem.BasePersUnit.hexPosition), CInt(unititem.BasePersUnit.Hexnum), CInt(unititem.BasePersUnit.LOCIndex))
        'adds specific counter infor to collection for hex
        Me.AddObjecttoDisplay(Displaysprite)
        'check to see if crest, sewer, or other location counter needs to be displayed - inherent locations only
        Me.CheckforAssociatedLocationCounter(Displaysprite)
        End If
        Next
        'add SW
        SWinhex = (From GetSW As ObjectClassLibrary.ASLXNA.SuppWeapi In Scencolls.SWCol Where GetSW.BaseSW.Hexnum = pHexnum Select GetSW).ToList
        'Loop through counters
        For Each OBSWitem As ObjectClassLibrary.ASLXNA.SuppWeapi In SWinhex
        Dim TextureName As String = OBSWitem.SetTexture()
        If Not IsNothing(TextureName) Then
        OBSWitem.BaseSW.OBTexture = GameContent.Content.Load(Of Texture2D)(Trim(TextureName))
        Displaysprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(OBSWitem.BaseSW.Unit_ID, CInt(OBSWitem.BaseSW.hexlocation), CInt(OBSWitem.BaseSW.LOBLink), OBSWitem.BaseSW.OBTexture, OBSWitem.BaseSW.DrawPos(MapGeo.MapBtype, MapGeo.Xoffset, MapGeo.Yoffset, MapGeo.MaxCols, MapGeo.MaxRows), OBSWitem.BaseSW.UnitName, CInt(OBSWitem.BaseSW.hexPosition), CInt(OBSWitem.BaseSW.Hexnum), CInt(OBSWitem.BaseSW.LOCIndex))
        'adds specific counter infor to collection for hex
        Me.AddObjecttoDisplay(Displaysprite)
        'check to see if crest, sewer, or other location counter needs to be displayed - inherent locations only
        Me.CheckforAssociatedLocationCounter(Displaysprite)
        End If
        Next
        'add vehicle
        Vehinhex = Linqdata.GetVehiclesInHex(Me.Hexnum).ToList
        'Loop through counters
        For Each Vehitem As DataClassLibrary.AFV In Vehinhex
        'determines if a counter should be visible and if so sets the texture
        Dim TextureName As String = Vehitem.SetTexture()
        If Not IsNothing(TextureName) Then
        Vehitem.VehTexture = GameContent.Content.Load(Of Texture2D)(Trim(TextureName))
        Displaysprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(Vehitem.AFVID, CInt(Vehitem.hexlocation), CInt(Vehitem.AFVDefaultsID), Vehitem.VehTexture, Vehitem.DrawPos(MapGeo.MapBtype, MapGeo.Xoffset, MapGeo.Yoffset, MapGeo.MaxCols, MapGeo.MaxRows), Vehitem.AFVName, CInt(Vehitem.Position), CInt(Vehitem.hexnum), CInt(Vehitem.LocIndex))
        'adds specific counter infor to collection for each occupied hex
        Me.AddObjecttoDisplay(Displaysprite)
        End If
        Next
        'add Gun
        'Guninhex = Game.Linqdata.getguninhex(Me.Hexnum, Game.Scenario.ScenID).tolist
        'add Terrain, visibility and misc
        Dim TerrainActions = New ObjectClassLibrary.ASLXNA.TerrainActionsC(GameContent)
        Dim GetLocs As New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(LocationCol)
        Dim LocationsInhex = GetLocs.RetrieveLocationsinHex(Me.Hexnum, "Hexnum")
        For Each LOCToUse As MapDataClassLibrary.GameLocation In LocationsInhex
        TerrainActions.ShowTerrainInLocation(LOCToUse)
        Next
        'sniper
        Dim Sniperhex As MapDataClassLibrary.GameLocation : Dim sidetoget As Integer = 0
        Dim Scendet As DataClassLibrary.scen = Linqdata.GetScenarioData(ScenID) 'retrieves scenario data
        Dim util = New UtilClassLibrary.ASLXNA.ConversionC : Dim Sniperid As Integer = 0
        If Scendet.Sanattaloc = Me.Hexnum Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sanattaloc))
        sidetoget = CInt(Scendet.ATT1)
        Sniperid = util.GetSnipervalue(sidetoget, "A")
        TerrainActions.SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sanattbloc = Me.Hexnum Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sanattbloc))
        sidetoget = CInt(Scendet.ATT1)
        Sniperid = util.GetSnipervalue(sidetoget, "B")
        TerrainActions.SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sandfnaloc = Me.Hexnum Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sandfnaloc))
        sidetoget = CInt(Scendet.DFN1)
        Sniperid = util.GetSnipervalue(sidetoget, "A")
        TerrainActions.SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sandfnbloc = Me.Hexnum Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sandfnbloc))
        sidetoget = CInt(Scendet.DFN1)
        Sniperid = util.GetSnipervalue(sidetoget, "B")
        TerrainActions.SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        'creates list of hexes where counters are to be displayed
        If Me.VisibleCountersInHex.Count > 0 Then
        'if hex not already added, then add
        If Not (Drawcols.HexeswithCounter.ContainsKey(Me.Hexnum)) Then Drawcols.HexeswithCounter.Add(Me.Hexnum, Me)
        Else  'remove empty hex from list
        If Drawcols.HexeswithCounter.ContainsKey(Me.Hexnum) Then Drawcols.HexeswithCounter.Remove(Me.Hexnum)
        End If
        End Sub
        End Class

        Friend Class SortSprites
        'sorts all visible counters in a hex by "location" - includes things that are not strictly
        'a different location such as foxhole and wire - this is all about display

        'Constructor
        Sub New(ByVal VisibleCountersInHex As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder), ByVal hexnum As Integer)
        'called by VisibleOccupioedHexes.RedoDisplayOrder
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation) = Maptables.LocationCol
        'get base location of hex
        Dim LevelChk = New TerrainClassLibrary.ASLXNA.LevelChecks(LocationCol)
        Dim UsingHex As MapDataClassLibrary.GameLocation = LevelChk.GetLocationatLevelInHex(hexnum, 0)
        'assign each sprite in hex to a location -except sniper which goes on top
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In VisibleCountersInHex
        If Not Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.Sniper Then 'Skip snipers
        Select Case Displaycounter.hexloc 'this holds location occcupied by sprite
        Case UsingHex.Location, UsingHex.OtherTerraininLocation  'base location of hex
        'where sprite is in base location, check for position
        Select Case Displaycounter.hexposition
        Case ConstantClassLibrary.ASLXNA.AltPos.InFoxhole, ConstantClassLibrary.ASLXNA.AltPos.InTrench, ConstantClassLibrary.ASLXNA.Feature.Foxhole, ConstantClassLibrary.ASLXNA.Feature.Trench
        Foxhole.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Feature.Wire, ConstantClassLibrary.ASLXNA.AltPos.AboveWire
        Wire.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0
        CrestStatus0.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus1
        CrestStatus0.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus1, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus2
        CrestStatus1.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus3, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus3
        CrestStatus3.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus4, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus4
        CrestStatus4.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5, ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5
        CrestStatus5.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Feature.APMines, ConstantClassLibrary.ASLXNA.Feature.ATMines, ConstantClassLibrary.ASLXNA.Location.FortStoneGrd To ConstantClassLibrary.ASLXNA.Location.FortWood3rd
        Basehexloc.Add(Displaycounter)
        Case 0, ConstantClassLibrary.ASLXNA.AltPos.WallAdv, ConstantClassLibrary.ASLXNA.AltPos.Passenger, ConstantClassLibrary.ASLXNA.AltPos.Rider, ConstantClassLibrary.ASLXNA.VisHind.VehDust To ConstantClassLibrary.ASLXNA.VisHind.GreyWPDisp
        'this will include all fortified buildings as position will be 0
        Basehexloc.Add(Displaycounter)
        End Select
        'If Game.Scenario.TerrainActions.IsLocationAFortBuilding(Displaycounter.hexloc) Then Basehexloc.Add(Displaycounter)
        'Case constantclasslibrary.aslxna.Locations.BlazeGS, constantclasslibrary.aslxna.Locations.BlazeGW
        '    Basehexloc.Add(Displaycounter)
        'Case constantclasslibrary.aslxna.Locations.Building1stLevelS, constantclasslibrary.aslxna.Locations.Building1stLevelW,
        'constantclasslibrary.aslxna.Locations.FBuild1stLevelS, constantclasslibrary.aslxna.Locations.FRoofless1stLevelS, constantclasslibrary.aslxna.Locations.FBuild1stLevelW,
        'constantclasslibrary.aslxna.Locations.RBuilding1stLevelS, constantclasslibrary.aslxna.Locations.RBuilding1stLevelW, constantclasslibrary.aslxna.Locations.GRBuilding1stLevelS,
        'constantclasslibrary.aslxna.Locations.Roofless1stLevelS, constantclasslibrary.aslxna.Locations.Roofless1stLevelW, constantclasslibrary.aslxna.Locations.Gutted1stNoStairS,
        'constantclasslibrary.aslxna.Locations.Gutted1stInherentS, constantclasslibrary.aslxna.Locations.Gutted1stStairS, constantclasslibrary.aslxna.Locations.FGutted1stNoStairS,
        'constantclasslibrary.aslxna.Locations.FGutted1stInherentS, constantclasslibrary.aslxna.Locations.FGutted1stStairS, constantclasslibrary.aslxna.Locations.Blaze1stS,
        'constantclasslibrary.aslxna.Locations.Blaze1stW
        Case ConstantClassLibrary.ASLXNA.Location.Building1stLevel
        Building1stLevel.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Building2ndLevel
        Building2ndLevel.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Building3rdLevel
        Building3rdLevel.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Cellar, ConstantClassLibrary.ASLXNA.Location.BunkUnder  ', constantclasslibrary.aslxna.Locations.CellarMan, constantclasslibrary.aslxna.Locations.BlazeCelS, constantclasslibrary.aslxna.Locations.BlazeCelW
        Cellar.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Roof
        Roof.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.InCave
        Case ConstantClassLibrary.ASLXNA.Location.BeneathPier

        Case ConstantClassLibrary.ASLXNA.Location.BeneathBridge
        BeneathBridge.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.StBr14 To ConstantClassLibrary.ASLXNA.Location.SWdBr36
        Bridge.Add(Displaycounter)
        'Case constantclasslibrary.aslxna.Locations.Bunker  NEED TO CONFIRM THIS - do we need a bunker counter?
        '    Bunker.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Pill1571 To ConstantClassLibrary.ASLXNA.Location.Bombprf
        Pillbox.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Sewer
        Sewer.Add(Displaycounter)
        Case ConstantClassLibrary.ASLXNA.Location.Tunnel
        Tunnel.Add(Displaycounter)
        End Select
        Else
        Sniper.Add(Displaycounter)
        End If
        Next
        'order the sprites within location; process by layer from bottom to top
        Dim Layercount As Integer = 0
        Dim DisplayOrderHolder As Double = 0
        'This order reflects the layer display order from bottom to top
        If Sewer.Count > 0 Then  'there is something to display
        'set the layer value
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Sewerlevel
        'sort the location
        Dim Sewerloc = New LocationSorted(Sewer, hexnum)
        'assign each sprite an overall display order value based on layer and location sort
        If Sewerloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Sewerloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        'reset the unsorted list of location contents to the sorted list
        Sewer = Sewerloc.SortedList
        End If
        If Tunnel.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.tunnellevel
        Dim Tunnelloc = New LocationSorted(Tunnel, hexnum)
        If Tunnelloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Tunnelloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Tunnel = Tunnelloc.SortedList
        End If
        If Cellar.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Cellarlevel
        Dim Celloc = New LocationSorted(Cellar, hexnum)
        If Celloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Celloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Cellar = Celloc.SortedList
        End If
        If BeneathBridge.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.beneathbridgelevel
        Dim BeneathBridgeloc = New LocationSorted(BeneathBridge, hexnum)
        If BeneathBridgeloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In BeneathBridgeloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        BeneathBridge = BeneathBridgeloc.SortedList
        End If
        'If Bunker.Count > 0 Then
        '    Layercount = constantclasslibrary.aslxna.DisplayLevel.Baselevel
        '    Dim Bunkerloc = New LocationSorted(Bunker)
        '    If Bunkerloc.SortedList.Count > 0 Then
        '        For Each DisplayCounter As SpriteOrder In Bunkerloc.SortedList
        '            DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        '            DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        '        Next
        '    End If
        '    Bunker = Bunkerloc.SortedList
        'End If
        If Pillbox.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Pilllevel
        Dim Pillboxloc = New LocationSorted(Pillbox, hexnum)
        If Pillboxloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Pillboxloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Pillbox = Pillboxloc.SortedList
        End If
        If Foxhole.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Entrenchlevel
        Dim FoxholeLoc = New LocationSorted(Foxhole, hexnum)
        If FoxholeLoc.SortedList.Count > 0 Then
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In FoxholeLoc.SortedList
        DisplayOrderHolder = Displaycounter.DisplayOrder / 100
        Displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If Wire.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.wirelevel
        Dim Wireloc = New LocationSorted(Wire, hexnum)
        If Wireloc.SortedList.Count > 0 Then
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Wireloc.SortedList
        DisplayOrderHolder = Displaycounter.DisplayOrder / 100
        Displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus0.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest1level
        Dim Crest1 = New LocationSorted(CrestStatus0, hexnum)
        If Crest1.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest1.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus0.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest2level
        Dim Crest2 = New LocationSorted(CrestStatus0, hexnum)
        If Crest2.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest2.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus1.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest3level
        Dim Crest3 = New LocationSorted(CrestStatus1, hexnum)
        If Crest3.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest3.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus3.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest4level
        Dim Crest4 = New LocationSorted(CrestStatus3, hexnum)
        If Crest4.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest4.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus4.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest5level
        Dim Crest5 = New LocationSorted(CrestStatus4, hexnum)
        If Crest5.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest5.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If CrestStatus5.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.crest6level
        Dim Crest6 = New LocationSorted(CrestStatus5, hexnum)
        If Crest6.SortedList.Count > 0 Then
        For Each displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Crest6.SortedList
        DisplayOrderHolder = displaycounter.DisplayOrder / 100
        displaycounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        End If
        If Basehexloc.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Baselevel
        Dim Sortbaseloc = New LocationSorted(Basehexloc, hexnum)
        If Sortbaseloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Sortbaseloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Basehexloc = Sortbaseloc.SortedList
        End If
        If Bridge.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.OnBridgelevel
        Dim Bridgeloc = New LocationSorted(Bridge, hexnum)
        If Bridgeloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Bridgeloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Bridge = Bridgeloc.SortedList
        End If
        If Building1stLevel.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Firstlevel
        Dim Sort1stloc = New LocationSorted(Building1stLevel, hexnum)
        If Sort1stloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Sort1stloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Building1stLevel = Sort1stloc.SortedList
        End If
        If Building2ndLevel.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Secondlevel
        Dim Sort2ndloc = New LocationSorted(Building2ndLevel, hexnum)
        If Sort2ndloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Sort2ndloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Building2ndLevel = Sort2ndloc.SortedList
        End If
        If Building3rdLevel.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Thirdlevel
        Dim Sort3rdloc = New LocationSorted(Building3rdLevel, hexnum)
        If Sort3rdloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In Sort3rdloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Building3rdLevel = Sort3rdloc.SortedList
        End If
        If Roof.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.Rooflevel
        Dim SortRoofloc = New LocationSorted(Roof, hexnum)
        If SortRoofloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortRoofloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Roof = SortRoofloc.SortedList
        End If
        If Sniper.Count > 0 Then
        Layercount = ConstantClassLibrary.ASLXNA.DisplayLevel.sniperlevel
        Dim SortSniperloc = New LocationSorted(Sniper, hexnum)
        If SortSniperloc.SortedList.Count > 0 Then
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortSniperloc.SortedList
        DisplayOrderHolder = DisplayCounter.DisplayOrder / 100
        DisplayCounter.DisplayOrder = Layercount + DisplayOrderHolder
        Next
        End If
        Sniper = SortSniperloc.SortedList
        End If
        End Sub
        'Properties
        Friend Property Basehexloc As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Building1stLevel As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Building2ndLevel As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Building3rdLevel As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Cellar As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Roof As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property BeneathBridge As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Bridge As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Bunker As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Pillbox As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Sewer As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Tunnel As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Foxhole As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Wire As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus0 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus0 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus1 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus3 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus4 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property CrestStatus5 As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property PassRid As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Friend Property Sniper As New List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        'Methods

        End Class

        Friend Class LocationSorted
        'called by SortSprites.New
        'sorts all visible counters in a location by display order
        Friend Property SortedList As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder)
        Private Scencolls As ObjectClassLibrary.ASLXNA.ScenarioCollectionsc = ObjectClassLibrary.ASLXNA.ScenarioCollectionsc.GetInstance
        Private linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance
        'Constructor
        Friend Sub New(ByVal LocationsContents As List(Of ObjectClassLibrary.ASLXNA.SpriteOrder), ByVal hexnum As Integer)
        SortedList = LocationsContents
        DoTheSort(hexnum)
        End Sub
        'Methods
        Private Sub DoTheSort(ByVal hexnum As Integer)
        'called by constructor
        'sorts sprites in a location, passed as list via the constructor
        Dim n As Integer = 0 'counter used to hold current displayorder value
        Dim Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Dim LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation) = Maptables.LocationCol
        Dim IsTerrChk = New TerrainClassLibrary.ASLXNA.IsTerrain(LocationCol)
        'certain terrain is shown first (level counters, bridge - "on" condition)
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Location, Displaycounter.TypeID) Or
        linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Feature, Displaycounter.TypeID) Then
        If Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Building1stLevel Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Building2ndLevel Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Building3rdLevel Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Roof Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.APMines Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.Wire Or
        (Displaycounter.TypeID >= ConstantClassLibrary.ASLXNA.Location.StBr14 And Displaycounter.TypeID <= ConstantClassLibrary.ASLXNA.Location.FoBr) Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.StoneRubble Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.WoodRubble Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.StoneRubbleFallen Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.WoodRubbleFallen Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.StoneRubbleFallTB Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.WoodRubbleFallTB Then
        n += 1
        Displaycounter.DisplayOrder = n
        ElseIf IsTerrChk.IsLocationTerrainA(hexnum, Displaycounter.hexloc, ConstantClassLibrary.ASLXNA.Location.FortBuildtype) And
        Not (IsTerrChk.IsLocationTerrainA(hexnum, Displaycounter.hexloc, ConstantClassLibrary.ASLXNA.Location.Cellartype)) Then
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        End If
        Next
        'concealed units, SW and dummies
        'first get concealment
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Concealment, Displaycounter.TypeID) Then
        'if Pass/Rider, don't display yet
        If Not linqdata.IsUnitAPassOrRider(Displaycounter.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Concealment) Then
        'find units under the counter - do OBUnits and OBSW and status together to get alignment right
        For Each DisplayUnit As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Personnel, DisplayUnit.TypeID) Then  'object is a Unit
        'get the unit
        Dim unittocheck As ObjectClassLibrary.ASLXNA.PersUniti = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = DisplayUnit.ObjID).First
        'if under the concealment then assign display value
        If unittocheck.BasePersUnit.Con_ID = Displaycounter.ObjID Then
        n += 1
        DisplayUnit.DisplayOrder = n
        'determine if has SW and if so assigns them to next display values
        If unittocheck.BasePersUnit.FirstSWLink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.FirstSWLink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        If unittocheck.BasePersUnit.SecondSWlink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.SecondSWlink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        End If
        End If
        Next
        'now assign display value to concealment counter
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        End If
        Next
        'unpossessed SW
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.SW, Displaycounter.TypeID) Then
        Try
        Dim OBSWToShow As ObjectClassLibrary.ASLXNA.SuppWeapi = (From selsw As ObjectClassLibrary.ASLXNA.SuppWeapi In Scencolls.SWCol Where selsw.BaseSW.Unit_ID = Displaycounter.ObjID AndAlso selsw.BaseSW.Owner = 0 Select selsw).First
        'unpossessed
        n += 1
        Displaycounter.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        Next
        'free unarmed
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Personnel, DisplayCounter.TypeID) Then  'object is a Unit
        'get the unit
        Dim unittocheck As ObjectClassLibrary.ASLXNA.PersUniti = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = DisplayCounter.ObjID).First
        'if unarmed and not prisoner then display
        If unittocheck.BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Unarmed Then
        'assign display value
        n += 1
        DisplayCounter.DisplayOrder = n
        End If
        End If
        Next
        'do unconcealed OBUnits and OBSW and status together to get alignment right
        For Each DisplayCounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Personnel, DisplayCounter.TypeID) Then  'object is a Unit
        'get the unit
        Dim unittocheck As ObjectClassLibrary.ASLXNA.PersUniti = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = DisplayCounter.ObjID).First
        'if Pass/Rider, don't display yet
        If Not linqdata.IsUnitAPassOrRider(unittocheck.BasePersUnit.Unit_ID, ConstantClassLibrary.ASLXNA.Typetype.Personnel) AndAlso Not unittocheck.BasePersUnit.OrderStatus = ConstantClassLibrary.ASLXNA.OrderStatus.Unarmed Then
        'assign display value if unconcealed
        If unittocheck.BasePersUnit.Con_ID = 0 Then
        n += 1
        DisplayCounter.DisplayOrder = n
        'determine if has SW and if so assigns them to next display values
        If unittocheck.BasePersUnit.FirstSWLink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.FirstSWLink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        If unittocheck.BasePersUnit.SecondSWlink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.SecondSWlink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        End If
        End If
        End If
        Next
        'do guns then vehicles then terrain
        'guns
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Gun, Displaycounter.TypeID) Then
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        Next
        'vehicle
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Vehicle, Displaycounter.TypeID) Then
        n += 1
        Displaycounter.DisplayOrder = n
        'look for Pass/Riders
        'do concealment first
        For Each Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Concealment, Displaysprite.TypeID) Then
        'if Pass/Rider, display
        If linqdata.IsUnitAPassOrRider(Displaycounter.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Concealment) Then
        'find units under the counter - do OBUnits and OBSW and status together to get alignment right
        For Each DisplayUnit As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Personnel, DisplayUnit.TypeID) Then  'sprite object is a Unit
        'is object as pass/rider
        If linqdata.IsUnitAPassOrRider(DisplayUnit.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Personnel) Then
        Dim CheckVel As DataClassLibrary.PassRider = linqdata.RetrievePassRider(DisplayUnit.ObjID, Displaycounter.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Personnel)
        If Not IsNothing(CheckVel) Then
        'get the unit
        Dim unittocheck As ObjectClassLibrary.ASLXNA.PersUniti = (From GetUnit As ObjectClassLibrary.ASLXNA.PersUniti In Scencolls.Unitcol Where GetUnit.BasePersUnit.Unit_ID = DisplayUnit.ObjID).First
        'if under the concealment then assign display value
        If unittocheck.BasePersUnit.Con_ID = Displaycounter.ObjID Then
        n += 1
        DisplayUnit.DisplayOrder = n
        'determine if has SW and if so assigns them to next display values
        If unittocheck.BasePersUnit.FirstSWLink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.FirstSWLink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        If unittocheck.BasePersUnit.SecondSWlink > 0 Then
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.BasePersUnit.SecondSWlink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Catch ex As Exception
        End Try
        End If
        End If
        End If
        End If
        End If

        Next
        'now assign display value to concealment counter
        n += 1
        Displaysprite.DisplayOrder = n
        End If
        End If
        Next
        'For Each CheckPassRider As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        '    If Game.Linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Concealment, CheckPassRider.TypeID) Then
        '        If Game.Linqdata.IsUnitAPassOrRider(CheckPassRider.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Concealment) Then
        '            Dim CheckVel As DataClassLibrary.PassRider = Game.Linqdata.RetrievePassRider(CheckPassRider.ObjID, Displaycounter.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Concealment)
        '            If Not IsNothing(CheckVel) Then
        '                n += 1
        '                CheckPassRider.DisplayOrder = n
        '            End If
        '        End If
        '    End If
        'Next
        'now do units
        For Each CheckPassRider As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Personnel, CheckPassRider.TypeID) Then
        If linqdata.IsUnitAPassOrRider(CheckPassRider.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Personnel) Then
        Dim CheckVel As DataClassLibrary.PassRider = linqdata.RetrievePassRider(CheckPassRider.ObjID, Displaycounter.ObjID, ConstantClassLibrary.ASLXNA.Typetype.Personnel)
        If Not IsNothing(CheckVel) Then
        n += 1
        CheckPassRider.DisplayOrder = n
        'determine if has SW and if so assigns them to next display values
        Dim unittocheck As DataClassLibrary.OrderofBattle = linqdata.GetUnitfromCol(CheckPassRider.ObjID)
        If unittocheck.FirstSWLink > 0 Then
        'match with object in Things in Hex
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.FirstSWLink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Exit For
        Catch ex As Exception
        End Try
        End If
        If unittocheck.SecondSWlink > 0 Then
        'match with object in Things in Hex
        Try
        Dim SWTofind As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In SortedList Where DoMatch.ObjID = unittocheck.SecondSWlink Select DoMatch).First
        'assign next display value
        n += 1
        SWTofind.DisplayOrder = n
        Exit For
        Catch ex As Exception
        End Try
        End If
        End If
        End If
        End If
        Next
        End If
        Next
        'certain terrain counters shown last - "in" condition
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Location, Displaycounter.TypeID) Or linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Feature, Displaycounter.TypeID) Or
        linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.AltPos, Displaycounter.TypeID) Then
        If Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Cellar Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.BunkUnder Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.Foxhole Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Sewer Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Location.Tunnel Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.Trench Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus0 Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus1 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus3 Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus4 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.CrestStatus5 Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus0 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus1 Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus2 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus3 Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus4 Or Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.AltPos.WACrestStatus5 Or
        (Displaycounter.TypeID >= ConstantClassLibrary.ASLXNA.Location.Pill1571 And Displaycounter.TypeID <= ConstantClassLibrary.ASLXNA.Location.Bombprf) Or
        Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.BOWreck Then
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        End If
        Next
        'visibility modifiers: Fire, Smoke, Dust go next
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.VisHind, Displaycounter.TypeID) Then
        Dim TerrChk = New TerrainClassLibrary.ASLXNA.ManageScenarioTerrain()   'class for various data-based terrain checks
        If TerrChk.IsFeatureVisHind(Displaycounter.TypeID) Then
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        End If
        Next
        'sniper on top
        For Each Displaycounter As ObjectClassLibrary.ASLXNA.SpriteOrder In SortedList
        If Displaycounter.TypeID = ConstantClassLibrary.ASLXNA.Feature.Sniper Then
        n += 1
        Displaycounter.DisplayOrder = n
        End If
        Next
        End Sub
        End Class

        Public Class TerrainActionsC
        Private linqdata As DataClassLibrary.ASLXNA.DataC = DataClassLibrary.ASLXNA.DataC.GetInstance
        Private Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)    'use null values for parameters when sure instance exists
        Private LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private Gamecontent As Microsoft.Xna.Framework.Game
        'constructor
        Public Sub New(ByVal passGameContent As Microsoft.Xna.Framework.Game)
        'use null values for parameters when sure instance exists
        LocationCol = Maptables.LocationCol
        Gamecontent = passGameContent
        End Sub
        Public Sub ShowTerrainCounters(ByVal scenid As Integer)
        'called by Scenario.createcounters


        'creates special terrain counter sprites as required by scenario situation
        Dim ManageScenT = New TerrainClassLibrary.ASLXNA.ManageScenarioTerrain
        'retrive list of scenario terrain objects

        Dim TerrainCounterShow As IQueryable(Of MapDataClassLibrary.GameLocation) = ManageScenT.ShowScenarioTerrain(LocationCol)
        'create sprites and add to hex collection
        For Each ShowCounter As MapDataClassLibrary.GameLocation In TerrainCounterShow
        ShowTerrainInLocation(ShowCounter)
        Next
        'sniper - create sprites
        Dim Sniperhex As MapDataClassLibrary.GameLocation : Dim sidetoget As Integer = 0
        Dim Scendet As DataClassLibrary.scen = linqdata.GetScenarioData(scenid) 'retrieves scenario data
        Dim GetLocs As New TerrainClassLibrary.ASLXNA.GetALocationFromMapTable(LocationCol)
        Dim util = New UtilClassLibrary.ASLXNA.ConversionC : Dim Sniperid As Integer = 0
        If Scendet.Sanattaloc > 0 Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sanattaloc))
        sidetoget = CInt(Scendet.ATT1)
        Sniperid = util.GetSnipervalue(sidetoget, "A")
        SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sanattbloc > 0 Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sanattbloc))
        sidetoget = CInt(Scendet.ATT1)
        Sniperid = util.GetSnipervalue(sidetoget, "B")
        SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sandfnaloc > 0 Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sandfnaloc))
        sidetoget = CInt(Scendet.DFN1)
        Sniperid = util.GetSnipervalue(sidetoget, "A")
        SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        If Scendet.Sandfnbloc > 0 Then
        Sniperhex = GetLocs.RetrieveLocationfromHex(CInt(Scendet.Sandfnbloc))
        sidetoget = CInt(Scendet.DFN1)
        Sniperid = util.GetSnipervalue(sidetoget, "B")
        SetSniperTextureAndCreateSprite(sidetoget, Sniperhex, Sniperid)
        End If
        End Sub
        Public Sub ShowTerrainInLocation(ByVal ShowCounter As MapDataClassLibrary.GameLocation)
        'called by Me.ShowTerrainCounters
        'determines if a counter(s) should be visible and if so, creates a sprite and sets the texture

        Dim TerrTexture As Texture2D = Nothing : Dim Getname As String = "" : Dim Drawsprite As ObjectClassLibrary.ASLXNA.SpriteOrder
        'go through types - can have multiple counters in a hex and location
        'APMines
        If ShowCounter.APMines > 0 And ShowCounter.APMinesVisible Then
        'if visible, set texture
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Feature.APMines, Getname)
        'if not no texture then create sprite
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ShowCounter.APMines, Getname)
        'add to hex collection
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'ATMines
        If ShowCounter.ATMines > 0 And ShowCounter.ATMinesVisible Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Feature.ATMines, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ShowCounter.ATMines, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'wire
        If ShowCounter.IsWire And ShowCounter.WireVisible Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Feature.Wire, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Feature.Wire, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'smoke
        If ShowCounter.Smoke > 0 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Location.Smoketype, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ShowCounter.Smoke, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'Rubble
        If ShowCounter.IsRubble And ShowCounter.ShowCounter Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Location.Rubbletype, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ShowCounter.Location, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'Pillbox
        If ShowCounter.IsPillbox Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Location.Pillboxtype, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ShowCounter.Location, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'Fortified
        If ShowCounter.IsFortified Then
        Dim Feattype As Integer = 0
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Location.FortBuildtype, Getname)
        Select Case ShowCounter.LevelInHex
        Case -1
        Feattype = ConstantClassLibrary.ASLXNA.Location.Cellar
        Case 0
        If ShowCounter.IsStone Then Feattype = ConstantClassLibrary.ASLXNA.Location.FortStoneGrd Else Feattype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        Case 1
        If ShowCounter.IsStone Then Feattype = ConstantClassLibrary.ASLXNA.Location.FortSTone1st Else Feattype = ConstantClassLibrary.ASLXNA.Location.FortWood1st
        Case 2
        If ShowCounter.IsStone Then Feattype = ConstantClassLibrary.ASLXNA.Location.FortStone2nd Else Feattype = ConstantClassLibrary.ASLXNA.Location.FortWood2nd
        Case 3
        If ShowCounter.IsStone Then Feattype = ConstantClassLibrary.ASLXNA.Location.FortSTone3rd Else Feattype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        Case Else
        Feattype = 0
        End Select
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, Feattype, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'Roadblock  - need to check each hexside  -COME BACK AND USE DYNAMIC LINQ QUERY TO DO THIS AS A LOOP
        If ShowCounter.Hexside1 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock0 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock0, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock0, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        If ShowCounter.Hexside2 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock1 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock1, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock1, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        If ShowCounter.Hexside3 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock2 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock2, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock2, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        If ShowCounter.Hexside4 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock3 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock3, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock3, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        If ShowCounter.Hexside5 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock4 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock4, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock4, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        If ShowCounter.Hexside6 = ConstantClassLibrary.ASLXNA.Hexside.Roadblock6 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Hexside.Roadblock6, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, ConstantClassLibrary.ASLXNA.Hexside.Roadblock6, Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'OBA
        If ShowCounter.OBA > 0 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Location.OBAtype, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, CInt(ShowCounter.OBA), Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'Entrenchment
        If ShowCounter.Entrenchment > 0 Then
        TerrTexture = SetTextureandName(ShowCounter, ConstantClassLibrary.ASLXNA.Feature.entrenchment, Getname)
        If Not IsNothing(TerrTexture) Then Drawsprite = CreateSprite(ShowCounter, TerrTexture, CInt(ShowCounter.Entrenchment), Getname)
        AddToDisplay(ShowCounter, Drawsprite)
        End If
        'ANY OTHER TERRAIN TYPES? wreck, strat loc, control

        End Sub
        Public Function SetSniperTextureAndCreateSprite(ByVal sidetoget As Integer, ByVal sniperhex As MapDataClassLibrary.GameLocation, ByVal snipervalue As Integer) As Boolean
        'called by Me.ShowTerrainCounters
        'determines if a counter(s) should be visible and if so, creates a sprite and sets the texture
        Dim snipTexture As Microsoft.Xna.Framework.Graphics.Texture2D : Dim Drawsprite As ObjectClassLibrary.ASLXNA.SpriteOrder
        'set texture name
        Dim TextureName As String = Trim(linqdata.GetNatInfo(sidetoget, 2)) & "Sniper"
        'load the sniper texture
        Try
        snipTexture = Gamecontent.Content.Load(Of Texture2D)(Trim(TextureName))
        Catch
        MessageBox.Show("The god damn image file isn't loading", "GetTexture(Scenterrain)")
        End Try
        'if not no texture then create sprite
        If Not IsNothing(snipTexture) Then
        Dim DrawPos As Vector2 = GetDrawpos(sniperhex.Hexnum)
        Drawsprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(snipervalue, CInt(sniperhex.Location), ConstantClassLibrary.ASLXNA.Feature.Sniper,
        snipTexture, DrawPos, "Sniper", ConstantClassLibrary.ASLXNA.Feature.Sniper, sniperhex.Hexnum, sniperhex.LocIndex)
        'add to hex collection
        AddToDisplay(sniperhex, Drawsprite)
        End If
        End Function
        Private Function SetTextureandName(ByVal Showcounter As MapDataClassLibrary.GameLocation, ByVal Typetoget As Integer, ByRef GetName As String) As Texture2D
        'called by Me.ShowScenarioTerrain
        'modelled on ScenFeat.SetTexture()
        'gets texture and name for non-unit counters
        Dim TerrTexture As String = ""
        Dim Passtype As Integer = 0
        Dim TerrCheck As TerrainClassLibrary.ASLXNA.TerrainChecks = New TerrainClassLibrary.ASLXNA.TerrainChecks(LocationCol)
        Dim SideCheck As TerrainClassLibrary.ASLXNA.IsSide = New TerrainClassLibrary.ASLXNA.IsSide(LocationCol)
        Select Case Typetoget
        Case ConstantClassLibrary.ASLXNA.Feature.APMines
        TerrTexture = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Showcounter.APMines, Maptables)
        GetName = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Showcounter.APMines, Maptables)
        Case ConstantClassLibrary.ASLXNA.Feature.ATMines
        TerrTexture = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Showcounter.ATMines, Maptables)
        GetName = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Showcounter.ATMines, Maptables)
        Case ConstantClassLibrary.ASLXNA.Feature.Wire
        TerrTexture = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Feature.Wire, Maptables)
        GetName = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, ConstantClassLibrary.ASLXNA.Feature.Wire, Maptables)
        Case ConstantClassLibrary.ASLXNA.Location.Rubbletype
        TerrTexture = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Showcounter.Location, Maptables)
        GetName = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Showcounter.Location, Maptables)
        Case ConstantClassLibrary.ASLXNA.Location.Pillboxtype
        TerrTexture = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Showcounter.Location, Maptables)
        GetName = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Showcounter.Location, Maptables)
        Case ConstantClassLibrary.ASLXNA.Location.FortBuildtype
        Select Case Showcounter.LevelInHex
        Case -1
        Passtype = ConstantClassLibrary.ASLXNA.Location.Cellar
        Case 0
        If Showcounter.IsStone Then Passtype = ConstantClassLibrary.ASLXNA.Location.FortStoneGrd Else Passtype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        Case 1
        If Showcounter.IsStone Then Passtype = ConstantClassLibrary.ASLXNA.Location.FortSTone1st Else Passtype = ConstantClassLibrary.ASLXNA.Location.FortWood1st
        Case 2
        If Showcounter.IsStone Then Passtype = ConstantClassLibrary.ASLXNA.Location.FortStone2nd Else Passtype = ConstantClassLibrary.ASLXNA.Location.FortWood2nd
        Case 3
        If Showcounter.IsStone Then Passtype = ConstantClassLibrary.ASLXNA.Location.FortSTone3rd Else Passtype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        Case Else
        Passtype = 0
        End Select
        TerrTexture = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Passtype, Maptables)
        GetName = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Passtype, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock0
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock0, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock0, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock1
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock1, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock1, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock2
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock2, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock2, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock3
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock3, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock3, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock4
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock4, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock4, Maptables)
        Case ConstantClassLibrary.ASLXNA.Hexside.Roadblock6
        TerrTexture = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, ConstantClassLibrary.ASLXNA.Hexside.Roadblock6, Maptables)
        GetName = SideCheck.GetSideData(ConstantClassLibrary.ASLXNA.TerrFactor.Hexsidedesc, ConstantClassLibrary.ASLXNA.Hexside.Roadblock6, Maptables)
        'Case OBA

        Case ConstantClassLibrary.ASLXNA.Feature.entrenchment
        TerrTexture = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(Showcounter.Entrenchment), Maptables)
        GetName = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, CInt(Showcounter.Entrenchment), Maptables)
        Case ConstantClassLibrary.ASLXNA.Location.Smoketype
        If Showcounter.Smoke >= ConstantClassLibrary.ASLXNA.VisHind.VehDust And Showcounter.Smoke <= ConstantClassLibrary.ASLXNA.VisHind.GreyWPDisp Then
        TerrTexture = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, CInt(Showcounter.Smoke), Maptables)
        GetName = TerrCheck.GetPositionData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, CInt(Showcounter.Smoke), Maptables)
        End If
        End Select

        If IsNothing(TerrTexture) Then
        Return Nothing
        Else
        Try
        Return Gamecontent.Content.Load(Of Texture2D)(Trim(TerrTexture))
        Catch
        MessageBox.Show("The god damn image file isn't loading", "TerrainActionsC.SetTextureandName")
        Return Nothing
        End Try
        End If
        End Function
        Private Function CreateSprite(ByVal Showcounter As MapDataClassLibrary.GameLocation, ByVal TerrTexture As Texture2D, ByVal Featuretype As Integer, ByVal Featurename As String) As ObjectClassLibrary.ASLXNA.SpriteOrder
        'called by Me.ShowTerrainInLocation
        'creates sprite for terrain feature to be shown on map
        Dim DrawPos As Vector2 = GetDrawpos(Showcounter.Hexnum)
        Dim DisplaySprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(Showcounter.LocIndex, CInt(Showcounter.Location), Featuretype,
        TerrTexture, DrawPos, Featurename, Featuretype, Showcounter.Hexnum, Showcounter.LocIndex)
        Return DisplaySprite
        End Function
        Private Function GetDrawpos(ByVal Hexnum As Integer) As Vector2
        'called by Me.Createsprite
        'returns topleft position of feature counter to draw
        Dim MapGeo As MapGeoClassLibrary.ASLXNA.MapGeoC = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        Dim Drawpos As Vector2
        Drawpos.X = CInt(MapGeo.GetCX(CInt(Hexnum)) - 23)
        Drawpos.Y = CInt(MapGeo.GetCY(CInt(Hexnum)) - 23)
        Return Drawpos
        End Function
        Private Sub AddToDisplay(ByVal Showcounter As MapDataClassLibrary.GameLocation, ByVal Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder)
        'called by Me. varous methods
        'adds to list of hexes with a counter texture to show
        Dim Drawcols As ObjectClassLibrary.ASLXNA.DrawCollectionsc = ObjectClassLibrary.ASLXNA.DrawCollectionsc.GetInstance
        'adds to collection of hexes where counters are to be displayed plus adds to list of sprites in a specified hex
        Dim hexnum As Integer = CInt(Showcounter.Hexnum)
        'adds to list of hexes with sprite
        If Not (Drawcols.HexeswithCounter.ContainsKey(hexnum)) Then
        'if hex not already added, then add
        Drawcols.HexeswithCounter.Add(hexnum, New ObjectClassLibrary.ASLXNA.VisibleOccupiedhex(hexnum, Gamecontent))
        End If
        'adds specific counter infor to collection for each occupied hex
        Dim OH As ObjectClassLibrary.ASLXNA.VisibleOccupiedhex
        OH = CType(Drawcols.HexeswithCounter(hexnum), ObjectClassLibrary.ASLXNA.VisibleOccupiedhex)
        OH.AddObjecttoDisplay(Displaysprite)
        OH = Nothing
        End Sub
        End Class
        Public Class ShowLocationCounter
        Private Checkloc As MapDataClassLibrary.GameLocation
        Private OH As ObjectClassLibrary.ASLXNA.VisibleOccupiedhex
        Private Maptables As MapDataClassLibrary.ASLXNA.MapDataC = MapDataClassLibrary.ASLXNA.MapDataC.GetInstance("", 0)   'use null values when sure that instance already exists
        Private Drawcols As ObjectClassLibrary.ASLXNA.DrawCollectionsc = ObjectClassLibrary.ASLXNA.DrawCollectionsc.GetInstance
        Private LocationCol As IQueryable(Of MapDataClassLibrary.GameLocation)
        Private linqdata As DataClassLibrary.ASLXNA.DataC
        Private Gamecontent As Microsoft.Xna.Framework.game

        Public Sub New(ByVal PassCheckloc As MapDataClassLibrary.GameLocation, ByVal passGamecontent As Microsoft.Xna.Framework.game)
        'called by searchahex.FortifiedBuildingCheck
        'handles display of fortified buidling counter when required
        Checkloc = PassCheckloc
        OH = CType(Drawcols.HexeswithCounter(Checkloc.Hexnum), ObjectClassLibrary.ASLXNA.VisibleOccupiedhex)
        LocationCol = Maptables.LocationCol
        linqdata = DataClassLibrary.ASLXNA.DataC.GetInstance()
        Gamecontent = passGamecontent
        End Sub
        Public Function ShowFortified() As Boolean
        'called by SearchAHex.FortifiedBuildingCheck
        'use this when actually want to show Fortified counter

        Dim Featuretype As Integer = 0
        'first check if already visible
        If Not IsNothing(OH) Then  'IsNothing means nothing visible in hex
        Try
        Dim Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder = (From DoMatch In OH.VisibleCountersInHex Where DoMatch.LocIndex = Checkloc.LocIndex And (DoMatch.TypeID >= ConstantClassLibrary.ASLXNA.Location.FortStoneGrd And DoMatch.TypeID <= ConstantClassLibrary.ASLXNA.Location.FortWood3rd)
        Select DoMatch).First
        Return True 'counter already exists so exit
        Catch ex As Exception
        End Try
        End If
        'now check if level counter exists
        'get level of location

        Dim LevelChk As New TerrainClassLibrary.ASLXNA.LevelChecks(LocationCol)
        Dim LocLevel As Single = LevelChk.GetLevelofLocation(Checkloc.LocIndex)
        If LocLevel <> 0 Then
        Dim DelSprite As ObjectClassLibrary.ASLXNA.SpriteOrder
        If Not IsNothing(OH) Then 'something is visible
        For Each Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder In OH.VisibleCountersInHex
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Location, Displaysprite.TypeID) Then  'terrain location counter
        Dim TestLevel As Single = LevelChk.GetLevelofLocation(Displaysprite.LocIndex)
        If LocLevel = TestLevel Then
        'delete level sprite and add fortified sprite
        DelSprite = Displaysprite
        Exit For
        End If
        End If
        Next
        If Not IsNothing(DelSprite) Then OH.VisibleCountersInHex.Remove(DelSprite)
        Select Case LocLevel
        Case -1
        Featuretype = ConstantClassLibrary.ASLXNA.Location.Cellar
        Case 1
        If Checkloc.IsStone Then Featuretype = ConstantClassLibrary.ASLXNA.Location.FortSTone1st Else Featuretype = ConstantClassLibrary.ASLXNA.Location.FortWood1st
        Case 2
        If Checkloc.IsStone Then Featuretype = ConstantClassLibrary.ASLXNA.Location.FortStone2nd Else Featuretype = ConstantClassLibrary.ASLXNA.Location.FortWood2nd
        Case 3
        If Checkloc.IsStone Then Featuretype = ConstantClassLibrary.ASLXNA.Location.FortSTone3rd Else Featuretype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        Case Else
        Featuretype = 0
        End Select
        End If
        Else
        If Checkloc.IsStone Then Featuretype = ConstantClassLibrary.ASLXNA.Location.FortStoneGrd Else Featuretype = ConstantClassLibrary.ASLXNA.Location.FortWoodGrd
        End If
        'if here then need to add new sprite counter
        If AddCounter(Featuretype) Then Return True Else Return False
        End Function
        Public Function CheckLevelInstead() As Boolean

        'use this if need to determine which counter to show

        If Checkloc.IsFortified And Checkloc.ShowCounter Then
        'use fortified counter
        ShowFortified()
        Return True
        Else
        'use level counter
        'get level of location
        Dim Levelchk = New TerrainClassLibrary.ASLXNA.LevelChecks(LocationCol)
        If Checkloc.LevelInHex <> 0 Then
        If Not IsNothing(OH) Then 'something is visible
        For Each Displaysprite As ObjectClassLibrary.ASLXNA.SpriteOrder In OH.VisibleCountersInHex
        If linqdata.IsThingATypeOf(ConstantClassLibrary.ASLXNA.Typetype.Location, Displaysprite.TypeID) Then  'terrain location counter
        Dim TestLevel As Single = Levelchk.GetLevelofLocation(Displaysprite.LocIndex)
        If Checkloc.LevelInHex = TestLevel Then
        'level counter already showing
        Return True
        End If
        End If
        Next
        End If
        'if no match then need to add level counter
        Dim FeaturetoAdd As Integer = GetLevelCounter(Checkloc.LevelInHex)
        AddCounter(FeaturetoAdd)
        Return True
        Else
        'no counter needed in baselevel
        Return True
        End If
        End If
        Return True
        End Function
        Private Function AddCounter(ByVal Featuretype As Integer) As Boolean
        'called by Me.Checklevelinstead, Me.ShowFortified
        'loads fortified building or level texture and adds to display collection
        Dim Drawcols = ObjectClassLibrary.ASLXNA.DrawCollectionsc.GetInstance
        Dim Drawpos As Microsoft.Xna.Framework.Vector2 : Dim Terrtexture As Texture2D : Dim Getname As String : Dim Terrstrg As String
        Dim MapGeo As MapGeoClassLibrary.ASLXNA.MapGeoC = MapGeoClassLibrary.ASLXNA.MapGeoC.GetInstance(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        Drawpos.X = CInt(MapGeo.GetCX(CInt(Checkloc.Hexnum)) - 23)
        Drawpos.Y = CInt(MapGeo.GetCY(CInt(Checkloc.Hexnum)) - 23)
        Dim TerrCheck = New TerrainClassLibrary.ASLXNA.TerrainChecks(LocationCol)
        Terrstrg = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Image, Featuretype, Maptables)
        Getname = TerrCheck.GetLocationData(ConstantClassLibrary.ASLXNA.TerrFactor.Desc, Featuretype, Maptables)
        If IsNothing(Terrstrg) Then
        Return Nothing
        Else
        Try
        Terrtexture = Gamecontent.Content.Load(Of Texture2D)(Trim(Terrstrg))
        Catch
        MessageBox.Show("The god damn image file isn't loading", "ShowFortified.addcounter")
        Return Nothing
        End Try
        End If
        Dim DisplaySprite = New ObjectClassLibrary.ASLXNA.SpriteOrder(Checkloc.LocIndex, CInt(Checkloc.Location), Featuretype,
        Terrtexture, Drawpos, Getname, Featuretype, Checkloc.Hexnum, Checkloc.LocIndex)
        If OH.VisibleCountersInHex.Count = 0 Then Drawcols.HexToDraw.Add(DisplaySprite)
        OH.AddObjecttoDisplay(DisplaySprite)
        OH.RedoDisplayOrder()
        Return True
        End Function
        Private Function GetLevelCounter(ByVal Loclevel As Single) As Integer
        Select Case Loclevel
        Case -1
        Return ConstantClassLibrary.ASLXNA.Location.Cellar
        Case 1
        Return ConstantClassLibrary.ASLXNA.Location.Building1stLevel
        Case 2
        Return ConstantClassLibrary.ASLXNA.Location.Building2ndLevel
        Case 3
        Return ConstantClassLibrary.ASLXNA.Location.Building3rdLevel
        End Select
        End Function
        End Class
        End Namespace*/

